(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{162:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(30),n(161);var r=n(155),o=n(176),l={phongDiffuse:{uniforms:{edge:{type:"i",value:!1},uDirLightPos:{type:"v3",value:new r.Ab},uDirLightColor:{type:"c",value:new r.m(16777215)},uMaterialColor:{type:"c",value:new r.m(16777215)},edgeColor:{type:"v4",value:new r.Bb(0,0,0,1)},edgeWidthRatio:{type:"f",value:.01},uKd:{type:"f",value:1},uBorder:{type:"f",value:.8}},vertexShader:["uniform float edgeWidthRatio;","uniform bool edge;","varying vec3 vNormal;","varying vec3 vViewPosition;","void main() {","vec3 pos = (vec4(position, 1.0)).xyz;","if(edge){","pos += normal * edgeWidthRatio;","gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);","}else{","vNormal = normalize( normalMatrix * normal );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0);","}","}"].join("\n"),fragmentShader:["uniform vec3 uMaterialColor;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform bool edge;","uniform vec4 edgeColor;","uniform float uKd;","uniform float uBorder;","varying vec3 vNormal;","varying vec3 vViewPosition;","void main() {","if(edge){","gl_FragColor = edgeColor;","}else{","vec4 lDirection = viewMatrix * vec4( uDirLightPos, 0.0 );","vec3 lVector = normalize( lDirection.xyz );","vec3 normal = normalize( vNormal );","float diffuse = dot( normal, lVector );","if ( diffuse > 0.6 ) { diffuse = 1.0; }","else if ( diffuse > -0.2 ) { diffuse = 0.6; }","else { diffuse = 0.3; }","gl_FragColor = vec4( uKd * uMaterialColor * uDirLightColor * diffuse * 1.5, 1.0 );","}","}"].join("\n")}},c=function(e){var t=l[e],n=(new o.a).children.find((function(e){return"dirlight"===e.name})),u=r.yb.clone(t.uniforms),c=t.vertexShader,h=t.fragmentShader,d=new r.ob({uniforms:u,vertexShader:c,fragmentShader:h});return d.uniforms.uDirLightPos.value=n.position,d.uniforms.uDirLightColor.value=n.color,d}},164:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return d}));n(30);var r=n(155),o=n(162),l=function(e,t){var n=[];e.forEach((function(e){e.children.forEach((function(e){e.geometry&&n.push(e.geometry),e.children.length>0&&e.children.forEach((function(e){e.geometry&&n.push(e.geometry)}))}))}));var l=r.j.mergeBufferGeometries(n),c=Object(o.a)("phongDiffuse");c.uniforms.uMaterialColor.value.copy(new r.m(1118481)),c.uniforms.edge.value=!0,c.uniforms.edgeWidthRatio.value=t,c.side=r.f;var h=new r.P(l,c);return h.matrixAutoUpdate=!1,h.name="toon",h},c=function(e,t,n,o,l,c,h){return e.children.forEach((function(e){e&&"wireframe"===e.name?t.add({targets:e.material,opacity:l?1:0,offset:c||0,duration:h||t.duration},c||0):e.children.forEach((function(e){if(e.material&&e.material.uniforms){var d=new r.m(e.material.uniforms.uMaterialColor.value.getHex()),m=o?e.initialColor:new r.m(n);l&&(m=new r.m(1184274)),m&&t.add({targets:d,r:[d.r,m.r],g:[d.g,m.g],b:[d.b,m.b],offset:c||0,duration:h||t.duration,update:function(){e.material.uniforms.uMaterialColor={type:"c",value:d}}},c||0)}e.children&&e.children.length>0&&e.children.forEach((function(e){if(e.material&&e.material.uniforms){!e.initialColor&&"LineBasicMaterial"!==e.material.type&&e.material.uniforms&&e.material.uniforms.uMaterialColor&&(e.initialColor=new r.m(e.material.uniforms.uMaterialColor.value.getHex()));var d=new r.m(e.material.uniforms.uMaterialColor.value.getHex()),m=o?e.initialColor:new r.m(n);l&&(m=new r.m(1184274)),m&&t.add({targets:d,r:[d.r,m.r],g:[d.g,m.g],b:[d.b,m.b],offset:c||0,duration:h||t.duration,update:function(){e.material.uniforms.uMaterialColor={type:"c",value:d}}},c||0)}e.children&&e.children.length>0&&e.children.forEach((function(e){if(e.material&&e.material.uniforms){e.initialColor||(e.initialColor=new r.m(e.material.uniforms.uMaterialColor.value.color.getHex()));var d=new r.m(e.material.color.getHex()),m=o?e.initialColor:new r.m(n);l&&(m=new r.m(1184274)),t.add({targets:d,r:[d.r,m.r],g:[d.g,m.g],b:[d.b,m.b],offset:c||0,duration:h||t.duration,update:function(){e.material.uniforms.uMaterialColor={type:"c",value:d}}},c||0)}}))}))}))})),t},h=function(e,t){e.children.forEach((function(e){e.children.forEach((function(e){e.geometry&&e.material.uniforms&&(e.initialColor||(e.initialColor=new r.m(e.material.uniforms.uMaterialColor.value.getHex())),e.material.uniforms.uMaterialColor={type:"c",value:new r.m(t)}),e.children&&e.children.length>0&&e.children.forEach((function(n){n.geometry&&n.material.uniforms&&(n.initialColor||(n.initialColor=new r.m(n.material.uniforms.uMaterialColor.value.getHex())),n.material.uniforms.uMaterialColor={type:"c",value:new r.m(t)}),n.children&&n.children.length>0&&e.children.forEach((function(e){e.geometry&&e.material.uniforms&&(e.initialColor||(e.initialColor=new r.m(e.material.uniforms.uMaterialColor.value.getHex())),e.material.uniforms.uMaterialColor={type:"c",value:new r.m(t)})}))}))}))}))},d=function(e,t){var n=[],o=[],l=new r.F({color:16777215,linewidth:1,transparent:!0,opacity:t?1:0});e.children.forEach((function(e){e.children.forEach((function(e){if(e.geometry&&e.material.uniforms){!e.initialColor&&e.material.uniforms.uMaterialColor&&(e.initialColor=new r.m(e.material.uniforms.uMaterialColor.value.getHex()),e.material.uniforms.uMaterialColor={type:"c",value:new r.m(16777215)});var t=new r.s(e.geometry);n.push(t)}e.children&&e.children.length>0&&e.children.forEach((function(t){if(t.geometry){!t.initialColor&&t.material.uniforms&&(t.initialColor=new r.m(t.material.uniforms.uMaterialColor.value.getHex()),t.material.uniforms.uMaterialColor={type:"c",value:new r.m(16777215)});var l=new r.Eb(t.geometry);"ToriiMesh"===e.name?o.push(l):n.push(l)}t.children&&t.children.length>0&&e.children.forEach((function(e){if(e.geometry&&e.material.uniforms){e.initialColor||(e.initialColor=new r.m(e.material.uniforms.uMaterialColor.value.getHex()),e.material.uniforms.uMaterialColor={type:"c",value:new r.m(16777215)});var t=new r.s(e.geometry);n.push(t)}}))}))}))}));var c=new r.G(r.j.mergeBufferGeometries(n),l);if(o.length>0){var h=new r.G(r.j.mergeBufferGeometries(o),l);h.name="ToriiWireframe",e.add(h)}return c.name="wireframe",c.matrixAutoUpdate=!1,e.add(c),c}},167:function(e,t,n){var content=n(205);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(61).default)("30fe1dfc",content,!0,{sourceMap:!1})},173:function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));n(31),n(32),n(156),n(30),n(161),n(12);var r=n(157),o=n(165),l=n(159),c=n(160),h=n(158),d=n(155),m=(n(47),n(27)),f=(n(188),n(190),n(191),n(192),n(193),n(194),n(86),n(113),n(181),n(22),n(46),n(197),function(){function e(e){this.manager=void 0!==e?e:d.o,this.dracoLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,object){e[t]=object},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,n,r){var o,l=this;o=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:d.K.extractUrlBase(e),l.manager.itemStart(e);var c=function(t){r?r(t):console.error(t),l.manager.itemError(e),l.manager.itemEnd(e)},h=new d.u(l.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.load(e,(function(data){try{l.parse(data,o,(function(n){t(n),l.manager.itemEnd(e)}),c)}catch(e){c(e)}}),n,c)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(data,path,e,t){var content,h={};if("string"==typeof data)content=data;else if(d.K.decodeText(new Uint8Array(data,0,4))===c){try{h[n.KHR_BINARY_GLTF]=new v(data)}catch(e){return void(t&&t(e))}content=h[n.KHR_BINARY_GLTF].content}else content=d.K.decodeText(new Uint8Array(data));var m=JSON.parse(content);if(void 0===m.asset||m.asset.version[0]<2)t&&t(new Error("GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(m.extensionsUsed)for(var i=0;i<m.extensionsUsed.length;++i){var f=m.extensionsUsed[i],_=m.extensionsRequired||[];switch(f){case n.KHR_LIGHTS_PUNCTUAL:h[f]=new o(m);break;case n.KHR_MATERIALS_UNLIT:h[f]=new l(m);break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:h[f]=new M(m);break;case n.KHR_DRACO_MESH_COMPRESSION:h[f]=new y(m,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:h[n.MSFT_TEXTURE_DDS]=new r;break;case n.KHR_TEXTURE_TRANSFORM:h[n.KHR_TEXTURE_TRANSFORM]=new w(m);break;default:_.indexOf(f)>=0&&console.warn('GLTFLoader: Unknown extension "'+f+'".')}}new W(m,h,{path:path||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(e,t)}}};var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function r(){if(!DDSLoader)throw new Error("GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=new DDSLoader}function o(e){this.name=n.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[n.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function l(){this.name=n.KHR_MATERIALS_UNLIT}o.prototype.loadLight=function(e){var t,n=this.lightDefs[e],r=new d.m(16777215);void 0!==n.color&&r.fromArray(n.color);var o=void 0!==n.range?n.range:0;switch(n.type){case"directional":(t=new DirectionalLight(r)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new PointLight(r)).distance=o;break;case"spot":(t=new SpotLight(r)).distance=o,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,t.angle=n.spot.outerConeAngle,t.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('GLTFLoader: Unexpected light type, "'+n.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==n.intensity&&(t.intensity=n.intensity),t.name=n.name||"light_"+e,Promise.resolve(t)},l.prototype.getMaterialType=function(){return d.Q},l.prototype.extendParams=function(e,t,n){var r=[];e.color=new d.m(1,1,1),e.opacity=1;var o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var l=o.baseColorFactor;e.color.fromArray(l),e.opacity=l[3]}void 0!==o.baseColorTexture&&r.push(n.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(r)};var c="glTF",h=1313821514,f=5130562;function v(data){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(data,0,12);if(this.header={magic:d.K.decodeText(new Uint8Array(data.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==c)throw new Error("GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var t=new DataView(data,12),r=0;r<t.byteLength;){var o=t.getUint32(r,!0);r+=4;var l=t.getUint32(r,!0);if(r+=4,l===h){var m=new Uint8Array(data,12+r,o);this.content=d.K.decodeText(m)}else if(l===f){var v=12+r;this.body=data.slice(v,v+o)}r+=o}if(null===this.content)throw new Error("GLTFLoader: JSON content not found.")}function y(e,t){if(!t)throw new Error("GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function w(){this.name=n.KHR_TEXTURE_TRANSFORM}function M(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return d.ob},extendParams:function(e,t,n){var r=t.extensions[this.name],o=ShaderLib.standard,l=UniformsUtils.clone(o.uniforms),c=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),h=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),m=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),f=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),v=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),y=o.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",c).replace("#include <metalnessmap_pars_fragment>",h).replace("#include <roughnessmap_fragment>",m).replace("#include <metalnessmap_fragment>",f).replace("#include <lights_physical_fragment>",v);delete l.roughness,delete l.metalness,delete l.roughnessMap,delete l.metalnessMap,l.specular={value:(new d.m).setHex(1118481)},l.glossiness={value:.5},l.specularMap={value:null},l.glossinessMap={value:null},e.vertexShader=o.vertexShader,e.fragmentShader=y,e.uniforms=l,e.defines={STANDARD:""},e.color=new d.m(1,1,1),e.opacity=1;var w=[];if(Array.isArray(r.diffuseFactor)){var M=r.diffuseFactor;e.color.fromArray(M),e.opacity=M[3]}if(void 0!==r.diffuseTexture&&w.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new d.m(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new d.m(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var _=r.specularGlossinessTexture;w.push(n.assignTexture(e,"glossinessMap",_)),w.push(n.assignTexture(e,"specularMap",_))}return Promise.all(w)},createMaterial:function(e){var t=new d.ob({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(source){var e=source.clone();e.isGLTFSpecularGlossinessMaterial=!0;for(var t=this.specularGlossinessParams,i=0,n=t.length;i<n;i++)e[t[i]]=source[t[i]];return e},refreshUniforms:function(e,t,n,r,o,l){if(!0===o.isGLTFSpecularGlossinessMaterial){var c,h=o.uniforms,d=o.defines;h.opacity.value=o.opacity,h.diffuse.value.copy(o.color),h.emissive.value.copy(o.emissive).multiplyScalar(o.emissiveIntensity),h.map.value=o.map,h.specularMap.value=o.specularMap,h.alphaMap.value=o.alphaMap,h.lightMap.value=o.lightMap,h.lightMapIntensity.value=o.lightMapIntensity,h.aoMap.value=o.aoMap,h.aoMapIntensity.value=o.aoMapIntensity,o.map?c=o.map:o.specularMap?c=o.specularMap:o.displacementMap?c=o.displacementMap:o.normalMap?c=o.normalMap:o.bumpMap?c=o.bumpMap:o.glossinessMap?c=o.glossinessMap:o.alphaMap?c=o.alphaMap:o.emissiveMap&&(c=o.emissiveMap),void 0!==c&&(c.isWebGLRenderTarget&&(c=c.texture),!0===c.matrixAutoUpdate&&c.updateMatrix(),h.uvTransform.value.copy(c.matrix)),o.envMap&&(h.envMap.value=o.envMap,h.envMapIntensity.value=o.envMapIntensity,h.flipEnvMap.value=o.envMap.isCubeTexture?-1:1,h.reflectivity.value=o.reflectivity,h.refractionRatio.value=o.refractionRatio,h.maxMipLevel.value=e.properties.get(o.envMap).__maxMipLevel),h.specular.value.copy(o.specular),h.glossiness.value=o.glossiness,h.glossinessMap.value=o.glossinessMap,h.emissiveMap.value=o.emissiveMap,h.bumpMap.value=o.bumpMap,h.normalMap.value=o.normalMap,h.displacementMap.value=o.displacementMap,h.displacementScale.value=o.displacementScale,h.displacementBias.value=o.displacementBias,null!==h.glossinessMap.value&&void 0===d.USE_GLOSSINESSMAP&&(d.USE_GLOSSINESSMAP="",d.USE_ROUGHNESSMAP=""),null===h.glossinessMap.value&&void 0!==d.USE_GLOSSINESSMAP&&(delete d.USE_GLOSSINESSMAP,delete d.USE_ROUGHNESSMAP)}}}}function _(e,t,n,r){d.A.call(this,e,t,n,r)}y.prototype.decodePrimitive=function(e,t){var n=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,c={},h={},d={};for(var m in l){var f=D[m]||m.toLowerCase();c[f]=l[m]}for(m in e.attributes){f=D[m]||m.toLowerCase();if(void 0!==l[m]){var v=n.accessors[e.attributes[m]],y=P[v.componentType];d[f]=y,h[f]=!0===v.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],o=h[n];void 0!==o&&(r.normalized=o)}t(e)}),c,d)}))}))},w.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},_.prototype=Object.create(d.A.prototype),_.prototype.constructor=_,_.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r*3+r,i=0;i!==r;i++)t[i]=n[o+i];return t},_.prototype.beforeStart_=_.prototype.copySampleValue_,_.prototype.afterEnd_=_.prototype.copySampleValue_,_.prototype.interpolate_=function(e,t,n,r){for(var o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=2*c,d=3*c,td=r-t,p=(n-t)/td,m=p*p,f=m*p,v=e*d,y=v-d,w=-2*f+3*m,M=f-m,_=1-w,x=M-m+p,i=0;i!==c;i++){var S=l[y+i+c],A=l[y+i+h]*td,R=l[v+i+c],T=l[v+i]*td;o[i]=_*S+x*A+w*R+M*T}return o};var x,S=0,A=1,R=2,T=3,C=4,L=5,E=6,P=(d.N,d.O,d.zb,d.Ab,d.Bb,d.wb,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),O={9728:d.T,9729:d.H,9984:d.V,9985:d.J,9986:d.U,9987:d.I},I={33071:d.k,33648:d.S,10497:d.lb},k=(d.f,d.v,d.W,d.D,d.t,d.E,d.x,d.X,d.x,d.b,d.a,d.vb,d.mb,d.Fb,d.Z,d.ub,d.db,d.sb,d.cb,d.q,d.ab,d.r,d.bb,d.tb,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),D={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},j={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},H={CUBICSPLINE:void 0,LINEAR:d.C,STEP:d.B},U="OPAQUE",F="MASK",G="BLEND",N={"image/png":d.jb,"image/jpeg":d.kb};function z(e,path){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:path+e}function B(e,object,t){for(var n in t.extensions)void 0===e[n]&&(object.userData.gltfExtensions=object.userData.gltfExtensions||{},object.userData.gltfExtensions[n]=t.extensions[n])}function K(object,e){void 0!==e.extras&&("object"===Object(m.a)(e.extras)?object.userData=e.extras:console.warn("GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function X(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var i=0,n=t.weights.length;i<n;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){var r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(i=0,n=r.length;i<n;i++)e.morphTargetDictionary[r[i]]=i}else console.warn("GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Y(e){for(var t="",n=Object.keys(e).sort(),i=0,r=n.length;i<r;i++)t+=n[i]+":"+e[n[i]]+";";return t}function V(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,n=e.itemSize,r=e.array.slice(0,t*n),i=0,o=0;i<t;++i)r[o++]=e.getX(i),n>=2&&(r[o++]=e.getY(i)),n>=3&&(r[o++]=e.getZ(i)),n>=4&&(r[o++]=e.getW(i));return new d.h(r,n,e.normalized)}return e.clone()}function W(e,n,r){this.json=e||{},this.extensions=n||{},this.options=r||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new d.xb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new d.u(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function $(e,t,n){var r=t.attributes,o=[];function l(t,r){return n.getDependency("accessor",t).then((function(t){e.addAttribute(r,t)}))}for(var c in r){var h=D[c]||c.toLowerCase();h in e.attributes||o.push(l(r[c],h))}if(void 0!==t.indices&&!e.index){var d=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));o.push(d)}return K(e,t),Promise.all(o).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,o=!1,i=0,l=t.length;i<l;i++){if(void 0!==(d=t[i]).POSITION&&(r=!0),void 0!==d.NORMAL&&(o=!0),r&&o)break}if(!r&&!o)return Promise.resolve(e);var c=[],h=[];for(i=0,l=t.length;i<l;i++){var d=t[i];if(r){var m=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):e.attributes.position;c.push(m)}if(o){m=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):e.attributes.normal;h.push(m)}}return Promise.all([Promise.all(c),Promise.all(h)]).then((function(n){for(var l=n[0],c=n[1],i=0,h=l.length;i<h;i++)e.attributes.position!==l[i]&&(l[i]=V(l[i]));for(i=0,h=c.length;i<h;i++)e.attributes.normal!==c[i]&&(c[i]=V(c[i]));for(i=0,h=t.length;i<h;i++){var d=t[i],m="morphTarget"+i;if(r&&void 0!==d.POSITION){var f=l[i];f.name=m;for(var v=e.attributes.position,y=0,w=f.count;y<w;y++)f.setXYZ(y,f.getX(y)+v.getX(y),f.getY(y)+v.getY(y),f.getZ(y)+v.getZ(y))}if(o&&void 0!==d.NORMAL){var M=c[i];M.name=m;var _=e.attributes.normal;for(y=0,w=M.count;y<w;y++)M.setXYZ(y,M.getX(y)+_.getX(y),M.getY(y)+_.getY(y),M.getZ(y)+_.getZ(y))}}return r&&(e.morphAttributes.position=l),o&&(e.morphAttributes.normal=c),e}))}(e,t.targets,n):e}))}return W.prototype.parse=function(e,t){var n=this,r=this.json,o=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var l={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};B(o,l,r),e(l)})).catch(t)},W.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r={},o={},l=0,c=t.length;l<c;l++)for(var h=t[l].joints,i=0,d=h.length;i<d;i++)e[h[i]].isBone=!0;for(var m=0,f=e.length;m<f;m++){var v=e[m];void 0!==v.mesh&&(void 0===r[v.mesh]&&(r[v.mesh]=o[v.mesh]=0),r[v.mesh]++,void 0!==v.skin&&(n[v.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=o},W.prototype.getDependency=function(e,t){var r=e+":"+t,o=this.cache.get(r);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this.loadMesh(t);break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this.loadBufferView(t);break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this.loadMaterial(t);break;case"texture":o=this.loadTexture(t);break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;case"light":o=this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,o)}return o},W.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,defs=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(defs.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t},W.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(e,n){r.load(z(t.uri,o.path),e,void 0,(function(){n(new Error('GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},W.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))},W.prototype.loadAccessor=function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var o=[];return void 0!==r.bufferView?o.push(this.getDependency("bufferView",r.bufferView)):o.push(null),void 0!==r.sparse&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then((function(e){var o,l,c=e[0],h=k[r.type],m=P[r.componentType],f=m.BYTES_PER_ELEMENT,v=f*h,y=r.byteOffset||0,w=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,M=!0===r.normalized;if(w&&w!==v){var _="InterleavedBuffer:"+r.bufferView+":"+r.componentType,x=t.cache.get(_);x||(o=new m(c),x=new InterleavedBuffer(o,w/f),t.cache.add(_,x)),l=new InterleavedBufferAttribute(x,h,y/f,M)}else o=null===c?new m(r.count*h):new m(c,y,r.count*h),l=new d.h(o,h,M);if(void 0!==r.sparse){var S=k.SCALAR,A=P[r.sparse.indices.componentType],R=r.sparse.indices.byteOffset||0,T=r.sparse.values.byteOffset||0,C=new A(e[1],R,r.sparse.count*S),L=new m(e[2],T,r.sparse.count*h);null!==c&&l.setArray(l.array.slice());for(var i=0,E=C.length;i<E;i++){var O=C[i];if(l.setX(O,L[i*h]),h>=2&&l.setY(O,L[i*h+1]),h>=3&&l.setZ(O,L[i*h+2]),h>=4&&l.setW(O,L[i*h+3]),h>=5)throw new Error("GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return l}))},W.prototype.loadTexture=function(e){var source,t=this,r=this.json,o=this.options,l=this.textureLoader,c=window.URL||window.webkitURL,h=r.textures[e],m=h.extensions||{},f=(source=m[n.MSFT_TEXTURE_DDS]?r.images[m[n.MSFT_TEXTURE_DDS].source]:r.images[h.source]).uri,v=!1;return void 0!==source.bufferView&&(f=t.getDependency("bufferView",source.bufferView).then((function(e){v=!0;var t=new Blob([e],{type:source.mimeType});return f=c.createObjectURL(t)}))),Promise.resolve(f).then((function(e){var r=Loader.Handlers.get(e);return r||(r=m[n.MSFT_TEXTURE_DDS]?t.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:l),new Promise((function(t,n){r.load(z(e,o.path),t,void 0,n)}))})).then((function(e){!0===v&&c.revokeObjectURL(f),e.flipY=!1,void 0!==h.name&&(e.name=h.name),source.mimeType in N&&(e.format=N[source.mimeType]);var t=(r.samplers||{})[h.sampler]||{};return e.magFilter=O[t.magFilter]||d.H,e.minFilter=O[t.minFilter]||d.I,e.wrapS=I[t.wrapS]||d.lb,e.wrapT=I[t.wrapT]||d.lb,e}))},W.prototype.assignTexture=function(e,t,r){var o=this;return this.getDependency("texture",r.index).then((function(l){if(!l.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":l.format=d.kb}if(o.extensions[n.KHR_TEXTURE_TRANSFORM]){var c=void 0!==r.extensions?r.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;c&&(l=o.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(l,c))}e[t]=l}))},W.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,o=this.extensions,l=void 0!==t.attributes.tangent,c=void 0!==t.attributes.color,h=void 0===t.attributes.normal,m=!0===e.isSkinnedMesh,f=Object.keys(t.morphAttributes).length>0,v=f&&void 0!==t.morphAttributes.normal;if(e.isPoints){var y="PointsMaterial:"+r.uuid,w=this.cache.get(y);w||(w=new PointsMaterial,d.M.prototype.copy.call(w,r),w.color.copy(r.color),w.map=r.map,w.lights=!1,this.cache.add(y,w)),r=w}else if(e.isLine){y="LineBasicMaterial:"+r.uuid;var M=this.cache.get(y);M||(M=new LineBasicMaterial,d.M.prototype.copy.call(M,r),M.color.copy(r.color),M.lights=!1,this.cache.add(y,M)),r=M}if(l||c||h||m||f){y="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(y+="specular-glossiness:"),m&&(y+="skinning:"),l&&(y+="vertex-tangents:"),c&&(y+="vertex-colors:"),h&&(y+="flat-shading:"),f&&(y+="morph-targets:"),v&&(y+="morph-normals:");var _=this.cache.get(y);_||(_=r.isGLTFSpecularGlossinessMaterial?o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(r):r.clone(),m&&(_.skinning=!0),l&&(_.vertexTangents=!0),c&&(_.vertexColors=VertexColors),h&&(_.flatShading=!0),f&&(_.morphTargets=!0),v&&(_.morphNormals=!0),this.cache.add(y,_)),r=_}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("GLTFLoader: Duplicating UVs to support aoMap."),t.addAttribute("uv2",new d.h(t.attributes.uv.array,2))),r.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=r},W.prototype.loadMaterial=function(e){var t,r=this.json,o=this.extensions,l=r.materials[e],c={},h=l.extensions||{},m=[];if(h[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var f=o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=f.getMaterialType(),m.push(f.extendParams(c,l,this))}else if(h[n.KHR_MATERIALS_UNLIT]){var v=o[n.KHR_MATERIALS_UNLIT];t=v.getMaterialType(),m.push(v.extendParams(c,l,this))}else{t=d.R;var y=l.pbrMetallicRoughness||{};if(c.color=new d.m(1,1,1),c.opacity=1,Array.isArray(y.baseColorFactor)){var w=y.baseColorFactor;c.color.fromArray(w),c.opacity=w[3]}void 0!==y.baseColorTexture&&m.push(this.assignTexture(c,"map",y.baseColorTexture)),c.metalness=void 0!==y.metallicFactor?y.metallicFactor:1,c.roughness=void 0!==y.roughnessFactor?y.roughnessFactor:1,void 0!==y.metallicRoughnessTexture&&(m.push(this.assignTexture(c,"metalnessMap",y.metallicRoughnessTexture)),m.push(this.assignTexture(c,"roughnessMap",y.metallicRoughnessTexture)))}!0===l.doubleSided&&(c.side=DoubleSide);var M=l.alphaMode||U;return M===G?c.transparent=!0:(c.transparent=!1,M===F&&(c.alphaTest=void 0!==l.alphaCutoff?l.alphaCutoff:.5)),void 0!==l.normalTexture&&t!==d.Q&&(m.push(this.assignTexture(c,"normalMap",l.normalTexture)),c.normalScale=new d.zb(1,1),void 0!==l.normalTexture.scale&&c.normalScale.set(l.normalTexture.scale,l.normalTexture.scale)),void 0!==l.occlusionTexture&&t!==d.Q&&(m.push(this.assignTexture(c,"aoMap",l.occlusionTexture)),void 0!==l.occlusionTexture.strength&&(c.aoMapIntensity=l.occlusionTexture.strength)),void 0!==l.emissiveFactor&&t!==d.Q&&(c.emissive=(new d.m).fromArray(l.emissiveFactor)),void 0!==l.emissiveTexture&&t!==d.Q&&m.push(this.assignTexture(c,"emissiveMap",l.emissiveTexture)),Promise.all(m).then((function(){var e;return e=t===d.ob?o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(c):new t(c),void 0!==l.name&&(e.name=l.name),e.map&&(e.map.encoding=sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=sRGBEncoding),e.specularMap&&(e.specularMap.encoding=sRGBEncoding),K(e,l),l.extensions&&B(o,e,l),e}))},W.prototype.loadGeometries=function(e){var t=this,r=this.extensions,o=this.primitiveCache;function l(e){return r[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return $(n,e,t)}))}for(var c,h,m=[],i=0,f=e.length;i<f;i++){var v,y=e[i],w=(h=void 0,(h=(c=y).extensions&&c.extensions[n.KHR_DRACO_MESH_COMPRESSION])?"draco:"+h.bufferView+":"+h.indices+":"+Y(h.attributes):c.indices+":"+Y(c.attributes)+":"+c.mode),M=o[w];if(M)m.push(M.promise);else v=y.extensions&&y.extensions[n.KHR_DRACO_MESH_COMPRESSION]?l(y):$(new d.i,y,t),o[w]={primitive:y,promise:v},m.push(v)}return Promise.all(m)},W.prototype.loadMesh=function(e){for(var t=this,n=this.json,r=(this.extensions,n.meshes[e]),o=r.primitives,l=[],i=0,c=o.length;i<c;i++){var h=void 0===o[i].material?x=x||new d.R({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.v}):this.getDependency("material",o[i].material);l.push(h)}return Promise.all(l).then((function(n){return t.loadGeometries(o).then((function(l){for(var c=[],i=0,h=l.length;i<h;i++){var m,f=l[i],v=o[i],y=n[i];if(v.mode===C||v.mode===L||v.mode===E||void 0===v.mode)!0===(m=!0===r.isSkinnedMesh?new d.qb(f,y):new d.P(f,y)).isSkinnedMesh&&m.normalizeSkinWeights(),v.mode===L?m.drawMode=TriangleStripDrawMode:v.mode===E&&(m.drawMode=TriangleFanDrawMode);else if(v.mode===A)m=new LineSegments(f,y);else if(v.mode===T)m=new Line(f,y);else if(v.mode===R)m=new LineLoop(f,y);else{if(v.mode!==S)throw new Error("GLTFLoader: Primitive mode unsupported: "+v.mode);m=new Points(f,y)}Object.keys(m.geometry.morphAttributes).length>0&&X(m,r),m.name=r.name||"mesh_"+e,l.length>1&&(m.name+="_"+i),K(m,r),t.assignFinalMaterial(m),c.push(m)}if(1===c.length)return c[0];var w=new d.y;for(i=0,h=c.length;i<h;i++)w.add(c[i]);return w}))}))},W.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new PerspectiveCamera(Math.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new OrthographicCamera(r.xmag/-2,r.xmag/2,r.ymag/2,r.ymag/-2,r.znear,r.zfar)),void 0!==n.name&&(t.name=n.name),K(t,n),Promise.resolve(t);console.warn("GLTFLoader: Missing camera parameters.")},W.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))},W.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],n=[],r=[],o=[],l=[],c=[],i=0,h=t.channels.length;i<h;i++){var m=t.channels[i],f=t.samplers[m.sampler],v=m.target,y=void 0!==v.node?v.node:v.id,input=void 0!==t.parameters?t.parameters[f.input]:f.input,output=void 0!==t.parameters?t.parameters[f.output]:f.output;n.push(this.getDependency("node",y)),r.push(this.getDependency("accessor",input)),o.push(this.getDependency("accessor",output)),l.push(f),c.push(v)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(o),Promise.all(l),Promise.all(c)]).then((function(n){for(var r=n[0],o=n[1],l=n[2],c=n[3],h=n[4],m=[],i=0,f=r.length;i<f;i++){var v=r[i],y=o[i],w=l[i],M=c[i],x=h[i];if(void 0!==v){var S;switch(v.updateMatrix(),v.matrixAutoUpdate=!0,j[x.path]){case j.weights:S=NumberKeyframeTrack;break;case j.rotation:S=d.ib;break;case j.position:case j.scale:default:S=d.Cb}var A=v.name?v.name:v.uuid,R=void 0!==M.interpolation?H[M.interpolation]:d.C,T=[];j[x.path]===j.weights?v.traverse((function(object){!0===object.isMesh&&object.morphTargetInfluences&&T.push(object.name?object.name:object.uuid)})):T.push(A);for(var C=0,L=T.length;C<L;C++){var track=new S(T[C]+"."+j[x.path],y.array,w.array,R);"CUBICSPLINE"===M.interpolation&&(track.createInterpolant=function(e){return new _(this.times,this.values,this.getValueSize()/3,e)},track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),m.push(track)}}}var E=void 0!==t.name?t.name:"animation_"+e;return new d.d(E,void 0,m)}))},W.prototype.loadNode=function(e){var t=this.json,r=this.extensions,o=this,l=t.meshReferences,c=t.meshUses,h=t.nodes[e];return(!0===h.isBone?Promise.resolve(new d.g):void 0!==h.mesh?o.getDependency("mesh",h.mesh).then((function(e){var t;if(l[h.mesh]>1){var n=c[h.mesh]++;(t=e.clone()).name+="_instance_"+n,t.onBeforeRender=e.onBeforeRender;for(var i=0,r=t.children.length;i<r;i++)t.children[i].name+="_instance_"+n,t.children[i].onBeforeRender=e.children[i].onBeforeRender}else t=e;return void 0!==h.weights&&t.traverse((function(e){if(e.isMesh)for(var i=0,t=h.weights.length;i<t;i++)e.morphTargetInfluences[i]=h.weights[i]})),t})):void 0!==h.camera?o.getDependency("camera",h.camera):h.extensions&&h.extensions[n.KHR_LIGHTS_PUNCTUAL]&&void 0!==h.extensions[n.KHR_LIGHTS_PUNCTUAL].light?o.getDependency("light",h.extensions[n.KHR_LIGHTS_PUNCTUAL].light):Promise.resolve(new d.Y)).then((function(e){if(void 0!==h.name&&(e.name=d.hb.sanitizeNodeName(h.name)),K(e,h),h.extensions&&B(r,e,h),void 0!==h.matrix){var t=new d.O;t.fromArray(h.matrix),e.applyMatrix(t)}else void 0!==h.translation&&e.position.fromArray(h.translation),void 0!==h.rotation&&e.quaternion.fromArray(h.rotation),void 0!==h.scale&&e.scale.fromArray(h.scale);return e}))},W.prototype.loadScene=function(){function e(t,n,r,o){var l=r.nodes[t];return o.getDependency("node",t).then((function(e){return void 0===l.skin?e:o.getDependency("skin",l.skin).then((function(e){for(var n=[],i=0,r=(t=e).joints.length;i<r;i++)n.push(o.getDependency("node",t.joints[i]));return Promise.all(n)})).then((function(n){for(var r=!0===e.isGroup?e.children:[e],i=0,o=r.length;i<o;i++){for(var l=r[i],c=[],h=[],m=0,f=n.length;m<f;m++){var v=n[m];if(v){c.push(v);var y=new d.O;void 0!==t.inverseBindMatrices&&y.fromArray(t.inverseBindMatrices.array,16*m),h.push(y)}else console.warn('GLTFLoader: Joint "%s" could not be found.',t.joints[m])}l.bind(new d.pb(c,h),l.matrixWorld)}return e}));var t})).then((function(t){n.add(t);var c=[];if(l.children)for(var h=l.children,i=0,d=h.length;i<d;i++){var m=h[i];c.push(e(m,t,r,o))}return Promise.all(c)}))}return function(t){var n=this.json,r=this.extensions,o=this.json.scenes[t],l=new d.nb;void 0!==o.name&&(l.name=o.name),K(l,o),o.extensions&&B(r,l,o);for(var c=o.nodes||[],h=[],i=0,m=c.length;i<m;i++)h.push(e(c[i],l,n,this));return Promise.all(h).then((function(){return l}))}}(),e}()),v=n(176),y={arraySlice:function(e,t,n){return y.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(object){return ArrayBuffer.isView(object)&&!(object instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),i=0;i!==t;++i)n[i]=i;return n.sort((function(i,t){return e[i]-e[t]})),n},sortedArray:function(e,t,n){for(var r=e.length,o=new e.constructor(r),i=0,l=0;l!==r;++i)for(var c=n[i]*t,h=0;h!==t;++h)o[l++]=e[c+h];return o},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var l=o[r];if(void 0!==l)if(Array.isArray(l))do{void 0!==(l=o[r])&&(t.push(o.time),n.push.apply(n,l)),o=e[i++]}while(void 0!==o);else if(void 0!==l.toArray)do{void 0!==(l=o[r])&&(t.push(o.time),l.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(l=o[r])&&(t.push(o.time),n.push(l)),o=e[i++]}while(void 0!==o)}},subclip:function(e,t,n,r,o){o=o||30;var l=e.clone();l.name=t;for(var c=[],i=0;i<l.tracks.length;++i){for(var track=l.tracks[i],h=track.getValueSize(),d=[],m=[],f=0;f<track.times.length;++f){var v=track.times[f]*o;if(!(v<n||v>=r)){d.push(track.times[f]);for(var w=0;w<h;++w)m.push(track.values[f*h+w])}}0!==d.length&&(track.times=y.convertArray(d,track.times.constructor),track.values=y.convertArray(m,track.values.constructor),c.push(track))}l.tracks=c;var M=1/0;for(i=0;i<l.tracks.length;++i)M>l.tracks[i].times[0]&&(M=l.tracks[i].times[0]);for(i=0;i<l.tracks.length;++i)l.tracks[i].shift(-1*M);return l.resetDuration(),l}};function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var M=function(e){Object(l.a)(m,e);var t,n=(t=m,function(){var e,n=Object(h.a)(t);if(w()){var r=Object(h.a)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(c.a)(this,e)});function m(){var e;return Object(r.a)(this,m),(e=n.call(this)).mixer=null,e.animationsCat=null,e.clock=new d.l,e.action=null,e}return Object(o.a)(m,[{key:"init",value:function(){var e=this;return new Promise((function(t,n){var r=new d.n;r.setDecoderPath("js/");var o=(new f).setPath("models/draco/");o.setDRACOLoader(r),o.load("cat_blender.glb",(function(n){var r=n.scene.children[0];e.animationsCat=n.animations[0],e.mixer=new d.e(r),e.walk(),e.cat=r;var head=e.cat.children[1].skeleton.bones.find((function(e){return"catms3dao_Bip01_Head"===e.name}));e.head=head;var o=new v.a;t({cat:r,light:o,head:head})}))}))}},{key:"walk",value:function(){this.action&&(this.action.stop(),this.action.reset(),this.action=null);var e=y.subclip(this.animationsCat,"idle",20,59,20);this.action=this.mixer.clipAction(e),this.action.timeScale=1,this.action.play()}},{key:"sleep",value:function(){var e=y.subclip(this.animationsCat,"fallSleep",4,18,30);this.action=this.mixer.clipAction(e),this.action.setLoop(d.L),this.action.timeScale=.8,this.action.clampWhenFinished=!0,this.action.play()}},{key:"run",value:function(e){this.action&&(this.action.stop(),this.action=null);var t=y.subclip(this.animationsCat,"run",60,83,20);this.action=this.mixer.clipAction(t),this.action.timeScale=e||1,this.action.play()}},{key:"playReverse",value:function(){this.action&&(this.action.stop(),this.action=null);var e=y.subclip(this.animationsCat,"run",60,83,20);this.action=this.mixer.clipAction(e),0===this.action.time&&(this.action.time=this.action.getClip().duration),this.action.paused=!1,this.action.timeScale=-1,this.action.play(),this.action.halt(5)}},{key:"jump",value:function(){this.action&&(this.action.stop(),this.action=null);var e=y.subclip(this.animationsCat,"jump",84,112,20),t=y.subclip(this.animationsCat,"sleep",4,18,20),n=this.mixer.clipAction(t);this.action=this.mixer.clipAction(e),this.action.timeScale=1.2,this.action.setLoop(d.L),n.timeScale=.8,n.setLoop(d.L),n.clampWhenFinished=!0,this.action.play(),this.mixer.addEventListener("finished",(function(e){n.play()}))}},{key:"jumpPlanet",value:function(){var e=this;this.action&&(this.action.stop(),this.action=null);var t=y.subclip(this.animationsCat,"jump",84,112,20);this.action=this.mixer.clipAction(t),this.action.timeScale=1.2,this.action.setLoop(d.L),this.action.play(),this.mixer.addEventListener("finished",(function(t){e.run()}))}},{key:"attack",value:function(){var e=y.subclip(this.animationsCat,"attack",115,149,20),t=this.mixer.clipAction(e);t.setLoop(d.L),t.timeScale=1.5,t.play()}},{key:"update",value:function(e){this.mixer&&(this.mixer.update(this.clock.getDelta()),e&&(this.head.rotation.y=e.x,this.head.rotation.z=-e.z))}}]),m}(d.y)},176:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n(31),n(32),n(12),n(156),n(30);var r=n(157),o=n(159),l=n(160),c=n(158),h=n(155);function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var m=function(e){Object(o.a)(m,e);var t,n=(t=m,function(){var e,n=Object(c.a)(t);if(d()){var r=Object(c.a)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(l.a)(this,e)});function m(){var e;Object(r.a)(this,m),e=n.call(this);var t=new h.z(16777215,16777215,2);t.position.set(0,50,0),t.name="hemilight";new h.c(4210752);var o=new h.p(16777215,5);o.position.set(-2.25,4.55,-.25),o.name="";var l=new h.gb(16777215,2,1);return l.position.set(2.25,3.55,-2.25),l.name="dirlight",e.add(l),e}return m}(h.y)},177:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(31),n(32),n(12),n(156),n(62),n(63),n(161),n(30);var r=n(157),o=n(159),l=n(160),c=n(158),h=n(155),d=n(162);function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var f=function(e){Object(o.a)(f,e);var t,n=(t=f,function(){var e,n=Object(c.a)(t);if(m()){var r=Object(c.a)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(l.a)(this,e)});function f(e,t){var o;Object(r.a)(this,f),(o=n.call(this)).name="Trees";var l=[],c=[],m=e.scene.children.find((function(e){return e.name.includes("Tree")})),v=m.children[0].material,y=m.children[1].material;e.scene.children.forEach((function(e){if(e.name.includes("Tree"))if(t)c.push(e.children[0].geometry),l.push(e.children[1].geometry);else for(var i=0;i<6;i++){var n=e.children[0].geometry.clone(),r=e.children[1].geometry.clone();n.translate(0,0,16*i),r.translate(0,0,16*i),c.push(n),l.push(r)}}));var w=h.j.mergeBufferGeometries(l),M=h.j.mergeBufferGeometries(c),_=Object(d.a)("phongDiffuse");_.uniforms.uMaterialColor.value.copy(new h.m(y.color.getHex()));var x=Object(d.a)("phongDiffuse");x.uniforms.uMaterialColor.value.copy(new h.m(v.color.getHex()));var S=new h.P(w,_),A=new h.P(M,x);return S.matrixAutoUpdate=!1,A.matrixAutoUpdate=!1,o.add(S,A),o}return f}(h.y)},182:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(31),n(32),n(12),n(156),n(62),n(63),n(161),n(30);var r=n(157),o=n(159),l=n(160),c=n(158),h=n(155),d=n(162);function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var f=function(e){Object(o.a)(f,e);var t,n=(t=f,function(){var e,n=Object(c.a)(t);if(m()){var r=Object(c.a)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(l.a)(this,e)});function f(e,t){var o;Object(r.a)(this,f),(o=n.call(this)).name="Rocks";var l=[],c=e.scene.children.find((function(e){return e.name.includes("Rock")})).material;e.scene.children.forEach((function(e){if(e.name.includes("Rock"))if(t)l.push(e.geometry);else for(var i=0;i<6;i++){var n=e.geometry.clone();n.translate(0,0,16*i),l.push(n)}}));var m=h.j.mergeBufferGeometries(l),v=Object(d.a)("phongDiffuse");v.uniforms.uMaterialColor.value.copy(new h.m(c.color.getHex()));var y=new h.P(m,v);return y.matrixAutoUpdate=!1,o.add(y),o}return f}(h.y)},184:function(e,t,n){"use strict";var r=n(28),o=n(174),l=n.n(o),c=n(155),h=(n(31),n(32),n(156),n(30),n(12),n(157)),d=n(165),m=n(159),f=n(160),v=n(158),y=(n(161),n(162));function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var M=function(e){Object(m.a)(r,e);var t,n=(t=r,function(){var e,n=Object(v.a)(t);if(w()){var r=Object(v.a)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(f.a)(this,e)});function r(e,t){var o;Object(h.a)(this,r),(o=n.call(this)).name="Kaio";var l=new c.y,d=new c.y,m=e.scene.children.find((function(e){return"House"===e.name})),f=m.children[0].geometry;(A=Object(y.a)("phongDiffuse")).uniforms.uMaterialColor.value.copy(new c.m(m.children[0].material.color.getHex()));var v=new c.P(f,A),w=m.children[1].geometry;(C=Object(y.a)("phongDiffuse")).uniforms.uMaterialColor.value.copy(new c.m(m.children[1].material.color.getHex()));var M=new c.P(w,C),_=m.children[2].geometry,x=Object(y.a)("phongDiffuse");x.uniforms.uMaterialColor.value.copy(new c.m(m.children[2].material.color.getHex()));var S=new c.P(_,x);v.matrixAutoUpdate=!1,M.matrixAutoUpdate=!1,S.matrixAutoUpdate=!1,d.add(v,M,S);var A,R=e.scene.children.find((function(e){return"Torii"===e.name})),T=R.children[0].geometry;(A=Object(y.a)("phongDiffuse")).uniforms.uMaterialColor.value.copy(new c.m(R.children[0].material.color.getHex()));var C,L=new c.P(T,A),E=R.children[1].geometry;(C=Object(y.a)("phongDiffuse")).uniforms.uMaterialColor.value.copy(new c.m(R.children[1].material.color.getHex()));var P=new c.P(E,C);return L.matrixAutoUpdate=!1,P.matrixAutoUpdate=!1,l.add(L,P),o.add(l,d),o}return r}(c.y),_=n(177);function x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var S=function(e){Object(m.a)(r,e);var t,n=(t=r,function(){var e,n=Object(v.a)(t);if(x()){var r=Object(v.a)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(f.a)(this,e)});function r(e,t){var o;Object(h.a)(this,r),(o=n.call(this)).name="Kaio";var l=e.scene.children.find((function(e){return"Icosphere"===e.name})),d=l.geometry,m=Object(y.a)("phongDiffuse");m.uniforms.uMaterialColor.value.copy(new c.m(l.material.color.getHex()));var f=new c.P(d,m),v=e.scene.children.find((function(e){return"Road"===e.name})),w=v.geometry,M=Object(y.a)("phongDiffuse");M.uniforms.uMaterialColor.value.copy(new c.m(v.material.color.getHex()));var _=new c.P(w,M);return o.add(f,_),o}return r}(c.y),A=n(173),R=n(182),T=n(164);function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var L=function(e){Object(m.a)(r,e);var t,n=(t=r,function(){var e,n=Object(v.a)(t);if(C()){var r=Object(v.a)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(f.a)(this,e)});function r(){return Object(h.a)(this,r),n.call(this)}return Object(d.a)(r,[{key:"init",value:function(){var e=this;return this.cat=new A.a,this.cat2=new A.a,this.cat3=new A.a,new Promise((function(t,n){var r=new c.n;r.setDecoderPath("js/");var o=(new c.w).setPath("models/draco/");o.setDRACOLoader(r),o.load("kaio_sakura.glb",(function(n){var r=new M(n),o=new S(n,!0),l=new _.a(n,!0),h=new R.a(n,!0);r.matrixAutoUpdate=!1,o.matrixAutoUpdate=!1,l.matrixAutoUpdate=!1,h.matrixAutoUpdate=!1,e.cellShading=Object(T.a)([o,r,l,h],.01),e.add(e.cellShading,o,r,l,h),e.catPivot=new c.Y,e.cat2Pivot=new c.Y,e.cat3Pivot=new c.Y,e.cat2Pivot.rotation.z=1.8,e.cat3Pivot.rotation.z=1.8,e.add(e.catPivot,e.cat2Pivot,e.cat3Pivot),e.rotation.x=-3.6,e.rotation.y=3.6,Object(T.c)(e,!0),Object(T.b)(e,1184274),e.cat2.init().then((function(t){t.cat=t.cat,t.cat.rotation.z=-.9,t.cat.scale.x=.36,t.cat.scale.y=.36,t.cat.scale.z=.36,t.cat.position.x=3,t.cat.position.y=3.445,t.cat.name="cat_2",e.cat2Pivot.add(t.cat,t.light),e.cat2.run(1.8)})),e.cat3.init().then((function(t){t.cat=t.cat,t.cat.rotation.z=-.9,t.cat.scale.x=.6,t.cat.scale.y=.6,t.cat.scale.z=.6,t.cat.position.x=3,t.cat.position.y=3.435,t.cat.name="cat_3",e.cat3Pivot.add(t.cat,t.light),e.cat3.walk()})),e.cat.init().then((function(n){e.catModel=n.cat,e.catModel.rotation.z=-.9,e.catModel.scale.x=.5,e.catModel.scale.y=.5,e.catModel.scale.z=.5,e.catModel.position.x=3,e.catModel.position.y=3.445,e.catModel.name="cat",e.catPivot.add(e.catModel,n.light),e.cat.run(),t()}))}))}))}},{key:"setSpeed",value:function(e){this.zSpeed=e}},{key:"getSpeed",value:function(){return this.zSpeed}},{key:"checkJumpHover",value:function(e,t,n,r){var o=this.cat3Pivot.rotation.z-e.rotation.z;o<.38&&o>.36&&!t.jumped&&(t.jumped=!0,t.jumpPlanet(),anime({targets:e.children[0].position,y:r,duration:n,easing:"easeOutSine",direction:"alternate",complete:function(){t.jumped=!1}}))}},{key:"update",value:function(e){this.cat.update(),this.cat2.update(),this.cat3.update(),this.rotation.z=-e/5e3%(2*Math.PI),this.catPivot.rotation.z=e/5e3*3.6%(2*Math.PI),this.cat2Pivot.rotation.z=e/5e3*5.2%(2*Math.PI),this.cat3Pivot.rotation.z=e/5e3%(2*Math.PI),this.checkJumpHover(this.cat2Pivot,this.cat2,400,4.14),this.checkJumpHover(this.catPivot,this.cat,500,4.14)}}]),r}(c.y),E=n(183),P=n.n(E),O={data:function(){var e={three:{}};return e.three={scene:{},camera:{aspect:0,fov:180,position:{x:0,y:0,z:-18},lookAt:{x:-2.4,y:0,z:-1}},renderer:{width:0,height:0,alpha:!0,antialias:!0,shadowMap:{enabled:!1}},object:{},render:{fps:30,deltaTime:0,lastTimeStamp:performance.now()}},{three:{$container:null,renderer:null,scene:null,camera:null,object:[]},setting:e}},mounted:function(){var e=this;this.planetScene=new L,this.init(),this.planetScene.init().then((function(){e.view()}))},methods:{init:function(){var e=this;this.animImg=!0,this.threshold=.1,this.smoothX=0,this.smoothY=0,this.scrollX=0,this.scrollY=134,this.percentage=134,this.coef=1,this.planetRotationX={value:1.45},this.$root.$on("scene",(function(filter){e.$root.scene=filter.state,2==e.$root.scene&&(e.isMobile?(e.scrollY=134,e.percentage=67,e.smoothScroll[0].smoothY=134):(e.scrollY=0,e.percentage=0,e.smoothScroll[0].smoothY=0),e.render(0),e.initMainAnim())})),this.smoothScroll=[{target:document.querySelector(".container_s .saturne"),threshold:.1,coef:.5,pos:!1,smoothY:134},{target:document.querySelector(".s_img img"),threshold:.11,coef:.05,pos:!0}],this.scrollInstance=new P.a({el:document.querySelector(".container_s"),limitInertia:!1,passive:!0,preventTouch:!0,touchMultiplier:5.5}),this.scrollInstance.on((function(t){e.$root.$emit("scroll"),e.scrollY=-t.y})),this.initInviews(),this.smoothScroll.forEach((function(element){element.smoothX=0,element.smoothY=element.smoothY||0,element.coef=element.coef||e.coef,element.threshold=element.threshold||e.threshold})),this.three.$container=document.getElementsByClassName("saturne_webgl")[0],this.setting.three.renderer.width=this.three.$container.clientWidth,this.setting.three.renderer.height=this.three.$container.clientHeight,this.three.scene=new c.nb,this.three.scene.rotation.set(0,.3,0),this.three.scene.position.x=-3,this.three.scene.position.z=3,this.three.camera=new c.fb(this.setting.three.camera.fov,this.setting.three.camera.aspect),this.three.camera.position.set(this.setting.three.camera.position.x,this.setting.three.camera.position.y,this.setting.three.camera.position.z),this.three.camera.lookAt(new c.Ab(this.setting.three.camera.lookAt.x,this.setting.three.camera.lookAt.y,this.setting.three.camera.lookAt.z)),this.three.camera.aspect=this.setting.three.renderer.width/this.setting.three.renderer.height,this.three.camera.updateProjectionMatrix(),this.three.renderer=new c.Db({alpha:this.setting.three.renderer.alpha,antialias:this.setting.three.renderer.antialias}),this.three.renderer.setSize(this.setting.three.renderer.width,this.setting.three.renderer.height),this.three.renderer.setPixelRatio(1.6),this.three.renderer.shadowMap.enabled=this.setting.three.renderer.shadowMap.enabled,this.three.renderer.gammaInput=this.setting.three.renderer.gammaInput,this.three.renderer.gammaOutput=this.setting.three.renderer.gammaOutput,this.three.renderer.gammaFactor=this.setting.three.renderer.gammaFactor;for(var t=this.three.$container;t.firstChild;)t.removeChild(t.firstChild);this.three.$container.appendChild(this.three.renderer.domElement)},initMainTl:function(){this.tlAnim1=null,this.tlAnim1=anime.timeline({autoplay:!1,duration:4e3,easing:"linear",update:this.updateHandler}),this.tlAnim1.mobile=!1,this.tlAnim1.add({targets:this.three.scene.position,x:3,duration:900,offset:0},0),this.tlAnim1.add({targets:this.three.scene.position,y:-3,z:-10,duration:2500,offset:0},0),this.tlAnim1.add({targets:this.planetRotationX,value:2.15,duration:2500,offset:0}),this.tlAnim1.add(Object(r.a)({targets:".saturne_background",opacity:[0,1],offset:0,easing:"easeInSine",duration:1e3},"offset",2400)),this.tlAnim1.add({targets:this.planetRotationX,value:1.45,duration:1500,offset:2500}),this.tlAnim1.add({targets:".performances",translateX:[0,"-200vw"],offset:0,duration:4e3}),this.tlAnim1.add({targets:this.three.scene.position,y:0,x:-3,z:-5,duration:1500,offset:2500,easing:"easeInQuint"}),this.tlAnim1.add({targets:".s_footer h1",offset:3e3,duration:1e3,translateY:0,update:function(e){e.animatables.forEach((function(t){t.target.style["font-variation-settings"]='"wght" '+Math.round((e.progress-75)/25*900)+', "SPAC" '+(120-Math.round((e.progress-75)/25*20))}))}},0),this.tlAnim1.seek(0)},initMobileMainTl:function(){this.tlAnim1=null,this.tlAnim1=anime.timeline({autoplay:!1,duration:4e3,easing:"linear",update:this.updateHandler}),this.tlAnim1.mobile=!0,this.tlAnim1.add({targets:this.three.scene.position,x:[-3,1],z:[3,0],duration:900,offset:0},0),this.tlAnim1.add({targets:this.three.scene.position,y:-3,duration:2500,offset:0},0),this.tlAnim1.add({targets:this.planetRotationX,value:[1.45,2.15],duration:2500,offset:0}),this.tlAnim1.add(Object(r.a)({targets:".saturne_background",opacity:[0,1],offset:0,easing:"easeInSine",duration:1e3},"offset",2400)),this.tlAnim1.add({targets:this.planetRotationX,value:[2.15,1],duration:1500,offset:2500}),this.tlAnim1.add({targets:".performances",translateX:[0,"-200vw"],offset:0,duration:4e3}),this.tlAnim1.add({targets:this.three.scene.position,y:[-3,-1.5],x:[1,-3],z:[0,3],duration:1500,offset:2500,easing:"easeInQuint"}),this.tlAnim1.add({targets:".s_footer h1",offset:3e3,duration:1e3,translateY:0,update:function(e){e.animatables.forEach((function(t){t.target.style["font-variation-settings"]='"wght" '+Math.round((e.progress-75)/25*900)+', "SPAC" '+(120-Math.round((e.progress-75)/25*20))}))}},0)},view:function(){this.containerEl=document.querySelector(".container"),this.clientHeight=this.containerEl.clientHeight||this.containerEl.offsetHeight,this.clientWidth=this.containerEl.clientWidth||this.containerEl.offsetWidth,this.isMobile=this.clientWidth<480,this.isMobile&&this.initMobileMainTl(),this.isMobile||this.initMainTl(),this.three.scene.add(this.planetScene),this.maxH=2*((document.querySelector(".container_s").clientHeight||document.querySelector(".container_s").offsetHeight)-window.innerHeight),this.event_assign()},render:function(e){var t=this;if(2==this.$root.scene){var n=this.scrollX,r=this.scrollY;this.smoothScroll.forEach((function(element){element.smoothX=t.lerp(element.smoothX,n,element.threshold),element.smoothY=t.lerp(element.smoothY,r,element.threshold),element.smoothX=Math.floor(1e3*element.smoothX)/1e3,element.smoothY=Math.floor(1e3*element.smoothY)/1e3,element.target.classList.contains("zoomd")?t.animImg&&(element.target.style.transform="scale(1.3) translate(-"+element.smoothX*element.coef+"px, "+(element.pos?"":"-")+(element.smoothY*element.coef*(t.isMobile?2200/t.clientHeight:3e3/t.clientHeight)-(t.isMobile,t.clientHeight/20))+"px)"):element.target.style.transform="translate(-"+element.smoothX*element.coef+"px, "+(element.pos?"":"-")+element.smoothY*element.coef+"px)"})),this.percentage=this.lerp(this.percentage,r,.7),this.percentage=Math.floor(1e3*this.percentage)/1e3,this.tlAnim1&&Math.round(this.tlAnim1.progress/100)*this.tlAnim1.duration!==Math.round(this.percentage)&&this.tlAnim1.seek(this.percentage*((this.isMobile?4134:4e3)/this.maxH)),this.animation(e),this.three.renderer.render(this.three.scene,this.three.camera),this.reqAnim=requestAnimationFrame(this.render)}},lerp:function(a,b,e){return(1-e)*a+e*b},initReverseAnim:function(){var e=this;this.tlAnimReverse=anime.timeline({easing:"easeInCubic",delay:0,duration:1400,autoplay:!1,complete:function(t){cancelAnimationFrame(self.reqAnim),e.$root.$emit("scene",{state:1})}}),this.tlAnimReverse.add({targets:".saturne_webgl",opacity:[1,0],duration:600,offset:800}),this.tlAnimReverse.add({targets:this.three.camera,fov:[50,180],duration:1200,update:this.updateHandler,offset:200}),this.tlAnimReverse.add({targets:".performances",opacity:[1,0],duration:600,offset:0}),this.tlAnimReverse.add({targets:".saturne_gob",opacity:0,offset:0,duration:600}),Object(T.d)(this.planetScene,this.tlAnimReverse,null,!0,!0,0,700),this.tlAnimReverse.play()},initMainAnim:function(){this.tlAnim=anime.timeline({easing:"linear",delay:0,duration:2800,autoplay:!1,complete:function(){document.querySelector("body").style.cursor="s-resize",window.blockScroll=!1}}),this.tlAnim.add({targets:".saturne_webgl",opacity:1,duration:300,offset:0}),this.tlAnim.add({targets:".saturne_gob",opacity:1,offset:2200,duration:600,easing:"easeOutQuint"}),this.tlAnim.add({targets:this.three.camera,fov:50,duration:700,update:this.updateHandler,offset:0}),this.tlAnim.add({targets:".performances",opacity:1,duration:800,offset:200}),Object(T.d)(this.planetScene,this.tlAnim,null,!0,!1,0,1600),this.tlAnim.play()},animation:function(e){this.mouseX&&this.mouseY&&this.three.camera&&(this.targetX=this.planetRotationX.value+.003*this.mouseX,this.targetY=.003*this.mouseY,this.planetScene.rotation.y+=.14*(this.targetX-this.planetScene.rotation.y),this.planetScene.rotation.x+=.14*(-this.targetY-this.planetScene.rotation.x)),this.planetScene.update&&this.planetScene.update(e)},event_assign:function(){var e=this;window.addEventListener("resize",this.resize,{once:!1,passive:!0,capture:!1}),document.querySelector(".saturne_gob").addEventListener("click",(function(t){2==e.$root.scene&&(document.querySelector("body").style.cursor="wait",window.blockScroll=!0,e.initReverseAnim(),anime({targets:".c_main_c",translateY:["-50%",0],duration:800,easing:"easeInCubic"}))})),window.DeviceOrientationEvent&&"ontouchstart"in window?window.addEventListener("deviceorientation",(function(t){var a=t.alpha,g=(t.beta,t.gamma);e.mouseY=.1,Math.abs(a<60)?e.mouseX=4.25*-g+3.5*-a:e.mouseX=6*-g}),!0):document.addEventListener("mousemove",this.moveMv)},initInviews:function(){var e=this;l()(".s_img zoomd").on("enter",(function(t){e.animImg=!0})),l()(".s_img zoomd").on("exit",(function(t){e.animImg=!1})),this.$root.$on("scroll",(function(){l()(".s_img zoomd").check()}))},moveMv:function(e){if(e.touches){var t=e.touches[0];e.clientX=1.6*(t.pageX-window.innerWidth/2),this.mouseY=.1}else this.mouseY=e.clientY-window.innerHeight/2;this.mouseX=e.clientX-window.innerWidth/2},resetMv:function(e){this.mouseX=.1,this.mouseY=.1},updateHandler:function(){this.three.camera.updateProjectionMatrix()},resize:function(){this.setting.three.renderer.width=this.three.$container.clientWidth||this.three.$container.offsetWidth,this.setting.three.renderer.height=this.three.$container.clientHeight||this.three.$container.offsetHeight,this.clientHeight=this.containerEl.clientHeight||this.containerEl.offsetHeight,this.clientWidth=this.containerEl.clientWidth||this.containerEl.offsetWidth,this.isMobile=this.clientWidth<480,this.isMobile&&!this.tlAnim1.mobile&&this.initMobileMainTl(),!this.isMobile&&this.tlAnim1.mobile&&this.initMainTl(),this.three.camera.aspect=this.setting.three.renderer.width/this.setting.three.renderer.height,this.three.camera.updateProjectionMatrix(),this.maxH=2*((document.querySelector(".container_s").clientHeight||document.querySelector(".container_s").offsetHeight)-window.innerHeight),this.three.renderer.setSize(this.setting.three.renderer.width,this.setting.three.renderer.height),this.three.renderer.render(this.three.scene,this.three.camera)}}},I=(n(204),n(20)),component=Object(I.a)(O,(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"saturne section_frame"},[n("div",{staticClass:"saturne_gob"},[e._v("CLICK HERE TO GO BACK")]),e._v(" "),n("div",{staticClass:"saturne_h"},[n("h1",{staticClass:"root_title"},[e._v("\n      This portfolio\n    ")]),e._v(" "),n("p",{staticClass:"root_dsc"},[e._v("I travelled in japan and I really loved the culture and the country. So I decided to make this portfolio and to go to live in Japan.")]),e._v(" "),n("div",{staticClass:"technos"},[e._v("Blender, Draco, ThreeJS, AnimeJS, Vue, Nuxt, Yarn, es6, PWA")])]),e._v(" "),n("div",[n("div",{staticClass:"dm_story s_arch"},[n("div",{staticClass:"md4"},[n("h2",[e._v("Architecture")])]),e._v(" "),n("div",{staticClass:"md8"},[n("p",[n("a",{attrs:{target:"_blank",rel:"noopener",href:"https://github.com/nuxt/nuxt.js"}},[e._v("NUXT.JS")]),e._v(", Yarn, Es6.\n          If you don't know Nuxt.js already it was made by the two french brothers Sébastien Chopin and Alexandre Chopin, and damn I love it.\n          The website total size is around 1.6mo transferred size, host on my AWS, served with http2 and gzip compression, and delivered with Cloudfare.\n        ")])])]),e._v(" "),n("div",{staticClass:"dm_story s_webgl"},[n("div",{staticClass:"md4"},[n("h2",[e._v("3D Optimisations")])]),e._v(" "),n("div",{staticClass:"md8"},[n("p",[e._v("I added a custom shader to limit the the diffusion of the light and to give it that low poly / toon effect. Furthemore, I added a custom cell shading to the shader which is just a copy of the scene merge in a unique geometry colorized black and translated by 0.02%. I didn't wanted to use the basic post-processing outline effect of Three for performances matters.")]),e._v(" "),n("p",[e._v("My optimisation process for the 3D is the following : Blender export glb > "),n("a",{attrs:{target:"_blank",rel:"noopener",href:"https://github.com/google/draco"}},[e._v("DRACO Compressor")]),e._v(" > ThreeJS gltf + DRACOLoader --\x3e Gzip. The result for the scene is a file size around 70ko (initial blender glb file is 1100ko (╯°□°)╯︵ ┻━┻)")])])]),e._v(" "),n("div",{staticClass:"dm_story s_perf"},[n("div",{staticClass:"md4"},[n("h2",[e._v("THREE Optimisations")])]),e._v(" "),n("div",{staticClass:"md8"},[n("p",[e._v("\n          The first best optimisation to do is to set every object with the property matrixAutoUpdate to false and manually call the updateMatrix() method when needed. The second is to merge and draw all the elements which are using the same material with THREE.BuffergeometryUtils. All the scenes on this portfolio are arounds 13 draws 120 calls / render.\n        ")]),e._v(" "),n("p",[e._v("For the infinite map I used the same process as in Detective Moustachio. There is 6 maps stacked and everytime 1 part of the map is offscreen I just translate the big block to the size of that part. All the process is on my "),n("a",{attrs:{href:"https://twitter.com/onirenaud",target:"_blank",rel:"noopener"}},[e._v("twitter")]),e._v(". The blender scene that I stack on the first part of the website is the following :")]),e._v(" "),n("div",{staticClass:"s_img"},[n("img",{staticClass:"zoomd",attrs:{alt:"main scene",src:"/img/scene.png"}})])])]),e._v(" "),n("div",{staticClass:"dm_story s_perf"},[n("div",{staticClass:"md4"},[n("h2",[e._v("Animations")])]),e._v(" "),n("div",{staticClass:"md8"},[n("p",[e._v("I used "),n("a",{attrs:{target:"_blank",rel:"noopener",href:"https://github.com/juliangarnier/anime"}},[e._v("Anime")]),e._v(" made by Julian Garnier for the animations. I mixed a custom smooth scroll to manually trigger the update (with the seek method) of my timelines in my main RequestAnim. For the font animation I used "),n("a",{attrs:{target:"_blank",rel:"noopener",href:"http://www.nmtype.com/movement/"}},[e._v("Movement")]),e._v(" a free variable font created by Noel Pretorius and Maria Ramos.")]),e._v(" "),n("p",[e._v("To avoid bad timing animations I try to always have only 1 requestAnim, avoid css animations and put all my stuff in it. If there is a fps drop, everything will be impacted and so the user will just experience a slower animation. Not a big deal instead of a choppy / unwanted timeline logic.")])])])]),e._v(" "),n("div",{staticClass:"s_footer"},[n("h1",{staticClass:"root_title"},[e._v("Contact")]),e._v(" "),n("div",[e._v("I am looking to collaborate with a great designer/agency to focus on development only. And yes, I love cats.")]),e._v("\n    ️️"),n("div",[n("a",{staticClass:"s_f_t",attrs:{href:"mailto:rohlinger@utsubo.co"}},[e._v("rohlinger@utsubo.co")])]),e._v(" "),n("div",[n("a",{staticClass:"s_f_t",attrs:{target:"_blank",rel:"noopener",href:"https://twitter.com/onirenaud"}},[e._v("@onirenaud")])]),e._v(" "),n("small",[e._v("Designed & developed by Renaud ROHLINGER © 2019. All Rights Reserved.")])])])}],!1,null,null,null);t.a=component.exports},204:function(e,t,n){"use strict";var r=n(167);n.n(r).a},205:function(e,t,n){(t=n(60)(!1)).push([e.i,'.s_img{overflow:hidden;background-color:#000}.s_img,.s_img img{width:100%;height:auto}.s_img img{max-width:600px;-webkit-transform:scale(1.3);transform:scale(1.3);margin:0 auto;display:block}.s_footer{display:block;position:relative;margin-top:160px;height:88vh}.s_footer div{max-width:46vw;display:block}.s_footer small{position:absolute;bottom:0;width:100%;left:0;text-align:center}.md4 h2{font-variation-settings:"wght" 700}.s_f_t{letter-spacing:1px;font-size:22px;font-weight:600;margin:14px 0;display:inline-block}.saturne,.saturne a{color:#fffcfc}.saturne .root_title{font-size:7vh;margin-top:-5px;line-height:7vh;white-space:nowrap;margin-bottom:1vh;font-variation-settings:"wght" 700}.saturne .root_dsc{max-width:600px}@media screen and (max-width:970px){.saturne{padding-top:67px!important}}@media screen and (max-width:480px){.saturne .root_title{font-size:9vw;line-height:9vw}}.technos{font-family:movement;font-variation-settings:"wght" 550;font-size:19px;bottom:0;position:absolute;left:0}.performances{position:fixed;z-index:-1;color:#fff;font-size:11.78vw;font-variation-settings:"wght" 900,"SPAC" 100;font-family:movement;-webkit-text-stroke:#fff;color:transparent;-webkit-text-stroke-width:1px;left:0;opacity:0;top:50%;margin-top:-6.89vw;white-space:nowrap;display:-webkit-box;display:flex}.performances span{width:100vw;display:inline-block;text-align:center}.saturne_gob{width:100%;text-align:center;font-size:21px;font-variation-settings:"wght" 300,"SPAC" 120;font-family:Movement;padding:21px;cursor:pointer;-webkit-transition:font-variation-settings .3s ease;transition:font-variation-settings .3s ease}.saturne_gob,.saturne_gob:after{position:absolute;top:0;opacity:0;left:0}.saturne_gob:after{content:"";right:0;bottom:0;-webkit-transition:opacity .3s ease;transition:opacity .3s ease;background:-webkit-gradient(linear,left top,left bottom,from(transparent),to(hsla(0,0%,100%,.07)));background:linear-gradient(180deg,transparent,hsla(0,0%,100%,.07))}.saturne_gob:hover{font-variation-settings:"wght" 900,"SPAC" 100}.saturne_gob:hover:after{opacity:1}.saturne_background{position:fixed;top:0;left:0;width:100vw;height:100vh;background:linear-gradient(8deg,#ceaf31 7%,#ecc010 18%,#f0d155 30%,#cb82c3 33%,#cb5dbf);z-index:-1;opacity:0}.saturne_background:after{content:"";z-index:0;background:linear-gradient(166deg,transparent 68%,rgba(0,0,0,.2) 90%);position:fixed;top:0;right:0;bottom:0;left:0}.saturne_h{height:84vh;position:relative}.saturne_webgl{position:fixed;top:0;left:0;width:100vw;height:100vh;opacity:0;pointer-events:none}@media screen and (max-width:480px){.saturne_gob{opacity:1}.s_footer{display:block;position:relative;height:100vh;margin-bottom:-6vh;padding-top:calc(8vw - 10px)}.s_footer div{max-width:100%}.saturne small{margin-bottom:6vw}.saturne.section_frame{padding:8vw}.saturne_h{height:100vh;margin-bottom:12vw;padding:8vw 0}.technos{bottom:8vw}}@media screen and (min-width:481px) and (max-width:1200px){.saturne small{margin-bottom:-4vw}.saturne.section_frame{padding:6vw}.technos{bottom:6vw}.s_footer{height:calc(100vh - 12vw)}.saturne_h{height:calc(100vh - 50px);margin-bottom:12vw;padding:0}}@media screen and (min-width:1201px){.saturne small{margin-bottom:-6vh}.saturne.section_frame{padding:8vh}.saturne_h{height:92vh;margin-bottom:8vh;padding:0}.technos{bottom:8vh}}',""]),e.exports=t}}]);