(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{256:function(e,t,r){"use strict";function n(e,t,r){return Math.min(t,Math.max(e,r))}r.d(t,"a",(function(){return n}))},257:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(131),o=function(e){n.C.call(this,e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};o.prototype=Object.assign(Object.create(n.C.prototype),{constructor:o,setDecoderPath:function(path){return this.decoderPath=path,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(e,t,r,o){var l=new n.m(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&l.setWithCredentials(!0),l.load(e,e=>{var r={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,r).then(t).catch(o)},r,o)},decodeDracoFile:function(e,t,r,n){var o={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,o).then(t)},decodeGeometry:function(e,t){for(var r in t.attributeTypes){var n=t.attributeTypes[r];void 0!==n.BYTES_PER_ELEMENT&&(t.attributeTypes[r]=n.name)}var l,c=JSON.stringify(t);if(o.taskCache.has(e)){var d=o.taskCache.get(e);if(d.key===c)return d.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var h=this.workerNextTaskID++,f=e.byteLength,m=this._getWorker(h,f).then(r=>(l=r,new Promise((r,n)=>{l._callbacks[h]={resolve:r,reject:n},l.postMessage({type:"decode",id:h,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return m.finally(()=>{l&&h&&this._releaseTask(l,h)}),o.taskCache.set(e,{key:c,promise:m}),m},_createGeometry:function(e){var t=new n.g;e.index&&t.setIndex(new n.f(e.index.array,1));for(var i=0;i<e.attributes.length;i++){var r=e.attributes[i],o=r.name,l=r.array,c=r.itemSize;t.setAttribute(o,new n.f(l,c))}return t},_loadLibrary:function(e,t){var r=new n.m(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),new Promise((t,n)=>{r.load(e,t,void 0,n)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;var e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{var r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);var n=o.DRACOWorker.toString(),body=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([body]))}),this.decoderPending},_getWorker:function(e,t){return this._initDecoder().then(()=>{var r;this.workerPool.length<this.workerLimit?((r=new Worker(this.workerSourceURL))._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(e){var t=e.data;switch(t.type){case"decode":r._callbacks[t.id].resolve(t);break;case"error":r._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},this.workerPool.push(r)):this.workerPool.sort((function(a,b){return a._taskLoad>b._taskLoad?-1:1}));return(r=this.workerPool[this.workerPool.length-1])._taskCosts[e]=t,r._taskLoad+=t,r})},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))},dispose:function(){for(var i=0;i<this.workerPool.length;++i)this.workerPool[i].terminate();return this.workerPool.length=0,this}}),o.DRACOWorker=function(){var e,t;function r(e,t,r,n,o,l){var c,d,h=l.num_components(),f=r.num_points()*h;switch(o){case Float32Array:c=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,l,c),d=new Float32Array(f);break;case Int8Array:c=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,l,c),d=new Int8Array(f);break;case Int16Array:c=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,l,c),d=new Int16Array(f);break;case Int32Array:c=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,l,c),d=new Int32Array(f);break;case Uint8Array:c=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,l,c),d=new Uint8Array(f);break;case Uint16Array:c=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,l,c),d=new Uint16Array(f);break;case Uint32Array:c=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,l,c),d=new Uint32Array(f);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var i=0;i<f;i++)d[i]=c.GetValue(i);return e.destroy(c),{name:n,array:d,itemSize:h}}onmessage=function(n){var o=n.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var l=o.buffer,c=o.taskConfig;t.then(e=>{var t=e.draco,n=new t.Decoder,d=new t.DecoderBuffer;d.Init(new Int8Array(l),l.byteLength);try{var h=function(e,t,n,o){var l,c,d=o.attributeIDs,h=o.attributeTypes,f=t.GetEncodedGeometryType(n);if(f===e.TRIANGULAR_MESH)l=new e.Mesh,c=t.DecodeBufferToMesh(n,l);else{if(f!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");l=new e.PointCloud,c=t.DecodeBufferToPointCloud(n,l)}if(!c.ok()||0===l.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+c.error_msg());var m={index:null,attributes:[]};for(var v in d){var y,T,w=self[h[v]];if(o.useUniqueIDs)T=d[v],y=t.GetAttributeByUniqueId(l,T);else{if(-1===(T=t.GetAttributeId(l,e[d[v]])))continue;y=t.GetAttribute(l,T)}m.attributes.push(r(e,t,l,v,w,y))}if(f===e.TRIANGULAR_MESH){for(var A=l.num_faces(),R=new Uint32Array(3*A),S=new e.DracoInt32Array,i=0;i<A;++i){t.GetFaceFromMesh(l,i,S);for(var M=0;M<3;++M)R[3*i+M]=S.GetValue(M)}m.index={array:R,itemSize:1},e.destroy(S)}return e.destroy(l),m}(t,n,d,c),f=h.attributes.map(e=>e.array.buffer);h.index&&f.push(h.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:h},f)}catch(e){console.error(e),self.postMessage({type:"error",id:o.id,error:e.message})}finally{t.destroy(d),t.destroy(n)}})}}},o.taskCache=new WeakMap,o.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},o.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},o.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},o.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")}},258:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(131),o=function(){function e(e){n.C.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,object){e[t]=object},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(n.C.prototype),{constructor:e,load:function(e,t,r,o){var l,c=this;l=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:n.D.extractUrlBase(e),c.manager.itemStart(e);var d=function(t){o?o(t):console.error(t),c.manager.itemError(e),c.manager.itemEnd(e)},h=new n.m(c.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),"use-credentials"===c.crossOrigin&&h.setWithCredentials(!0),h.load(e,(function(data){try{c.parse(data,l,(function(r){t(r),c.manager.itemEnd(e)}),d)}catch(e){d(e)}}),r,d)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(data,path,e,t){var content,h={};if("string"==typeof data)content=data;else if(n.D.decodeText(new Uint8Array(data,0,4))===d){try{h[r.KHR_BINARY_GLTF]=new m(data)}catch(e){return void(t&&t(e))}content=h[r.KHR_BINARY_GLTF].content}else content=n.D.decodeText(new Uint8Array(data));var f=JSON.parse(content);if(void 0===f.asset||f.asset.version[0]<2)t&&t(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(f.extensionsUsed)for(var i=0;i<f.extensionsUsed.length;++i){var T=f.extensionsUsed[i],R=f.extensionsRequired||[];switch(T){case r.KHR_LIGHTS_PUNCTUAL:h[T]=new l(f);break;case r.KHR_MATERIALS_UNLIT:h[T]=new c;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:h[T]=new w;break;case r.KHR_DRACO_MESH_COMPRESSION:h[T]=new v(f,this.dracoLoader);break;case r.MSFT_TEXTURE_DDS:h[T]=new o(this.ddsLoader);break;case r.KHR_TEXTURE_TRANSFORM:h[T]=new y;break;case r.KHR_MESH_QUANTIZATION:h[T]=new A;break;default:R.indexOf(T)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+T+'".')}}new W(f,h,{path:path||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(e,t)}}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function o(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=r.MSFT_TEXTURE_DDS,this.ddsLoader=e}function l(e){this.name=r.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[r.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function c(){this.name=r.KHR_MATERIALS_UNLIT}l.prototype.loadLight=function(e){var t,r=this.lightDefs[e],o=new n.j(16777215);void 0!==r.color&&o.fromArray(r.color);var l=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new n.k(o)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new n.T(o)).distance=l;break;case"spot":(t=new n.jb(o)).distance=l,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},c.prototype.getMaterialType=function(){return n.J},c.prototype.extendParams=function(e,t,r){var o=[];e.color=new n.j(1,1,1),e.opacity=1;var l=t.pbrMetallicRoughness;if(l){if(Array.isArray(l.baseColorFactor)){var c=l.baseColorFactor;e.color.fromArray(c),e.opacity=c[3]}void 0!==l.baseColorTexture&&o.push(r.assignTexture(e,"map",l.baseColorTexture))}return Promise.all(o)};var d="glTF",h=1313821514,f=5130562;function m(data){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(data,0,12);if(this.header={magic:n.D.decodeText(new Uint8Array(data.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==d)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var t=new DataView(data,12),o=0;o<t.byteLength;){var l=t.getUint32(o,!0);o+=4;var c=t.getUint32(o,!0);if(o+=4,c===h){var m=new Uint8Array(data,12+o,l);this.content=n.D.decodeText(m)}else if(c===f){var v=12+o;this.body=data.slice(v,v+l)}o+=l}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function v(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function y(){this.name=r.KHR_TEXTURE_TRANSFORM}function T(e){n.K.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),o=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),l=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),c=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),d={specular:{value:(new n.j).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=d,this.onBeforeCompile=function(e){for(var n in d)e.uniforms[n]=d[n];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),e.fragmentShader=e.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_pars_fragment>",t),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_pars_fragment>",r),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>",o),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_fragment>",l),e.fragmentShader=e.fragmentShader.replace("#include <lights_physical_fragment>",c)},Object.defineProperties(this,{specular:{get:function(){return d.specular.value},set:function(e){d.specular.value=e}},specularMap:{get:function(){return d.specularMap.value},set:function(e){d.specularMap.value=e}},glossiness:{get:function(){return d.glossiness.value},set:function(e){d.glossiness.value=e}},glossinessMap:{get:function(){return d.glossinessMap.value},set:function(e){d.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function w(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return T},extendParams:function(e,t,r){var o=t.extensions[this.name];e.color=new n.j(1,1,1),e.opacity=1;var l=[];if(Array.isArray(o.diffuseFactor)){var c=o.diffuseFactor;e.color.fromArray(c),e.opacity=c[3]}if(void 0!==o.diffuseTexture&&l.push(r.assignTexture(e,"map",o.diffuseTexture)),e.emissive=new n.j(0,0,0),e.glossiness=void 0!==o.glossinessFactor?o.glossinessFactor:1,e.specular=new n.j(1,1,1),Array.isArray(o.specularFactor)&&e.specular.fromArray(o.specularFactor),void 0!==o.specularGlossinessTexture){var d=o.specularGlossinessTexture;l.push(r.assignTexture(e,"glossinessMap",d)),l.push(r.assignTexture(e,"specularMap",d))}return Promise.all(l)},createMaterial:function(e){var t=new T(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=n.kb,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function A(){this.name=r.KHR_MESH_QUANTIZATION}function R(e,t,r,o){n.s.call(this,e,t,r,o)}v.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,o=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,c={},d={},h={};for(var f in l){var m=O[f]||f.toLowerCase();c[m]=l[f]}for(f in e.attributes){m=O[f]||f.toLowerCase();if(void 0!==l[f]){var v=r.accessors[e.attributes[f]],y=D[v.componentType];h[m]=y,d[m]=!0===v.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],o=d[r];void 0!==o&&(n.normalized=o)}t(e)}),c,h)}))}))},y.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},T.prototype=Object.create(n.K.prototype),T.prototype.constructor=T,T.prototype.copy=function(source){return n.K.prototype.copy.call(this,source),this.specularMap=source.specularMap,this.specular.copy(source.specular),this.glossinessMap=source.glossinessMap,this.glossiness=source.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},R.prototype=Object.create(n.s.prototype),R.prototype.constructor=R,R.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,o=e*n*3+n,i=0;i!==n;i++)t[i]=r[o+i];return t},R.prototype.beforeStart_=R.prototype.copySampleValue_,R.prototype.afterEnd_=R.prototype.copySampleValue_,R.prototype.interpolate_=function(e,t,r,n){for(var o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,d=2*c,h=3*c,td=n-t,p=(r-t)/td,f=p*p,m=f*p,v=e*h,y=v-h,T=-2*m+3*f,w=m-f,A=1-T,R=w-f+p,i=0;i!==c;i++){var S=l[y+i+c],M=l[y+i+d]*td,_=l[v+i+c],E=l[v+i]*td;o[i]=A*S+R*M+T*_+w*E}return o};var S=0,M=1,_=2,E=3,L=4,x=5,I=6,D={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},P={9728:n.M,9729:n.z,9984:n.O,9985:n.B,9986:n.N,9987:n.A},C={33071:n.i,33648:n.L,10497:n.db},U={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},O={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},k={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},H={CUBICSPLINE:void 0,LINEAR:n.u,STEP:n.t},F="OPAQUE",N="MASK",G="BLEND",j={"image/png":n.Y,"image/jpeg":n.Z};function B(e,path){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(path)&&/^\//.test(e)&&(path=path.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:path+e)}function K(e,object,t){for(var r in t.extensions)void 0===e[r]&&(object.userData.gltfExtensions=object.userData.gltfExtensions||{},object.userData.gltfExtensions[r]=t.extensions[r])}function V(object,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(object.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function X(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var i=0,r=t.weights.length;i<r;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){var n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(i=0,r=n.length;i<r;i++)e.morphTargetDictionary[n[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function z(e){for(var t="",r=Object.keys(e).sort(),i=0,n=r.length;i<n;i++)t+=r[i]+":"+e[r[i]]+";";return t}function W(e,r,o){this.json=e||{},this.extensions=r||{},this.options=o||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new n.lb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new n.m(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function J(e,t,r){var o=t.attributes,l=[];function c(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(var d in o){var h=O[d]||d.toLowerCase();h in e.attributes||l.push(c(o[d],h))}if(void 0!==t.indices&&!e.index){var f=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));l.push(f)}return V(e,t),function(e,t,r){var o=t.attributes,l=new n.e;if(void 0!==o.POSITION){var c=(y=r.json.accessors[o.POSITION]).min,d=y.max;if(void 0!==c&&void 0!==d){l.set(new n.rb(c[0],c[1],c[2]),new n.rb(d[0],d[1],d[2]));var h=t.targets;if(void 0!==h)for(var f=new n.rb,i=0,m=h.length;i<m;i++){var v=h[i];if(void 0!==v.POSITION){var y;c=(y=r.json.accessors[v.POSITION]).min,d=y.max;void 0!==c&&void 0!==d?(f.setX(Math.max(Math.abs(c[0]),Math.abs(d[0]))),f.setY(Math.max(Math.abs(c[1]),Math.abs(d[1]))),f.setZ(Math.max(Math.abs(c[2]),Math.abs(d[2]))),l.expandByVector(f)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}e.boundingBox=l;var T=new n.ib;l.getCenter(T.center),T.radius=l.min.distanceTo(l.max)/2,e.boundingSphere=T}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,r),Promise.all(l).then((function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,o=!1,i=0,l=t.length;i<l;i++){if(void 0!==(h=t[i]).POSITION&&(n=!0),void 0!==h.NORMAL&&(o=!0),n&&o)break}if(!n&&!o)return Promise.resolve(e);var c=[],d=[];for(i=0,l=t.length;i<l;i++){var h=t[i];if(n){var f=void 0!==h.POSITION?r.getDependency("accessor",h.POSITION):e.attributes.position;c.push(f)}if(o){f=void 0!==h.NORMAL?r.getDependency("accessor",h.NORMAL):e.attributes.normal;d.push(f)}}return Promise.all([Promise.all(c),Promise.all(d)]).then((function(t){var r=t[0],l=t[1];return n&&(e.morphAttributes.position=r),o&&(e.morphAttributes.normal=l),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}function Y(e,t){var r=e.getIndex();if(null===r){var o=[],l=e.getAttribute("position");if(void 0===l)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var i=0;i<l.count;i++)o.push(i);e.setIndex(o),r=e.getIndex()}var c=r.count-2,d=[];if(t===n.mb)for(i=1;i<=c;i++)d.push(r.getX(0)),d.push(r.getX(i)),d.push(r.getX(i+1));else for(i=0;i<c;i++)i%2==0?(d.push(r.getX(i)),d.push(r.getX(i+1)),d.push(r.getX(i+2))):(d.push(r.getX(i+2)),d.push(r.getX(i+1)),d.push(r.getX(i)));d.length/3!==c&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var h=e.clone();return h.setIndex(d),h}return W.prototype.parse=function(e,t){var r=this,n=this.json,o=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var l={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};K(o,l,n),V(l,n),e(l)})).catch(t)},W.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},o={},l=0,c=t.length;l<c;l++)for(var d=t[l].joints,i=0,h=d.length;i<h;i++)e[d[i]].isBone=!0;for(var f=0,m=e.length;f<m;f++){var v=e[f];void 0!==v.mesh&&(void 0===n[v.mesh]&&(n[v.mesh]=o[v.mesh]=0),n[v.mesh]++,void 0!==v.skin&&(r[v.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=o},W.prototype.getDependency=function(e,t){var n=e+":"+t,o=this.cache.get(n);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this.loadMesh(t);break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this.loadBufferView(t);break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this.loadMaterial(t);break;case"texture":o=this.loadTexture(t);break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;case"light":o=this.extensions[r.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,o)}return o},W.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,defs=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(defs.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t},W.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(e,r){n.load(B(t.uri,o.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},W.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))},W.prototype.loadAccessor=function(e){var t=this,r=this.json,o=this.json.accessors[e];if(void 0===o.bufferView&&void 0===o.sparse)return Promise.resolve(null);var l=[];return void 0!==o.bufferView?l.push(this.getDependency("bufferView",o.bufferView)):l.push(null),void 0!==o.sparse&&(l.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),l.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(l).then((function(e){var l,c,d=e[0],h=U[o.type],f=D[o.componentType],m=f.BYTES_PER_ELEMENT,v=m*h,y=o.byteOffset||0,T=void 0!==o.bufferView?r.bufferViews[o.bufferView].byteStride:void 0,w=!0===o.normalized;if(T&&T!==v){var A=Math.floor(y/T),R="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+A+":"+o.count,S=t.cache.get(R);S||(l=new f(d,A*T,o.count*T/m),S=new n.q(l,T/m),t.cache.add(R,S)),c=new n.r(S,h,y%T/m,w)}else l=null===d?new f(o.count*h):new f(d,y,o.count*h),c=new n.f(l,h,w);if(void 0!==o.sparse){var M=U.SCALAR,_=D[o.sparse.indices.componentType],E=o.sparse.indices.byteOffset||0,L=o.sparse.values.byteOffset||0,x=new _(e[1],E,o.sparse.count*M),I=new f(e[2],L,o.sparse.count*h);null!==d&&(c=new n.f(c.array.slice(),c.itemSize,c.normalized));for(var i=0,P=x.length;i<P;i++){var C=x[i];if(c.setX(C,I[i*h]),h>=2&&c.setY(C,I[i*h+1]),h>=3&&c.setZ(C,I[i*h+2]),h>=4&&c.setW(C,I[i*h+3]),h>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return c}))},W.prototype.loadTexture=function(e){var source,t=this,o=this.json,l=this.options,c=this.textureLoader,d=window.URL||window.webkitURL,h=o.textures[e],f=h.extensions||{},m=(source=f[r.MSFT_TEXTURE_DDS]?o.images[f[r.MSFT_TEXTURE_DDS].source]:o.images[h.source]).uri,v=!1;return void 0!==source.bufferView&&(m=t.getDependency("bufferView",source.bufferView).then((function(e){v=!0;var t=new Blob([e],{type:source.mimeType});return m=d.createObjectURL(t)}))),Promise.resolve(m).then((function(e){var n=l.manager.getHandler(e);return n||(n=f[r.MSFT_TEXTURE_DDS]?t.extensions[r.MSFT_TEXTURE_DDS].ddsLoader:c),new Promise((function(t,r){n.load(B(e,l.path),t,void 0,r)}))})).then((function(e){!0===v&&d.revokeObjectURL(m),e.flipY=!1,h.name&&(e.name=h.name),source.mimeType in j&&(e.format=j[source.mimeType]);var t=(o.samplers||{})[h.sampler]||{};return e.magFilter=P[t.magFilter]||n.z,e.minFilter=P[t.minFilter]||n.A,e.wrapS=C[t.wrapS]||n.db,e.wrapT=C[t.wrapT]||n.db,e}))},W.prototype.assignTexture=function(e,t,o){var l=this;return this.getDependency("texture",o.index).then((function(c){if(!c.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":c.format=n.Z}if(void 0===o.texCoord||0==o.texCoord||"aoMap"===t&&1==o.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+o.texCoord+" for texture "+t+" not yet supported."),l.extensions[r.KHR_TEXTURE_TRANSFORM]){var d=void 0!==o.extensions?o.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;d&&(c=l.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(c,d))}e[t]=c}))},W.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,o=void 0!==t.attributes.tangent,l=void 0!==t.attributes.color,c=void 0===t.attributes.normal,d=!0===e.isSkinnedMesh,h=Object.keys(t.morphAttributes).length>0,f=h&&void 0!==t.morphAttributes.normal;if(e.isPoints){var m="PointsMaterial:"+r.uuid,v=this.cache.get(m);v||(v=new n.V,n.E.prototype.copy.call(v,r),v.color.copy(r.color),v.map=r.map,v.sizeAttenuation=!1,this.cache.add(m,v)),r=v}else if(e.isLine){m="LineBasicMaterial:"+r.uuid;var y=this.cache.get(m);y||(y=new n.w,n.E.prototype.copy.call(y,r),y.color.copy(r.color),this.cache.add(m,y)),r=y}if(o||l||c||d||h){m="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(m+="specular-glossiness:"),d&&(m+="skinning:"),o&&(m+="vertex-tangents:"),l&&(m+="vertex-colors:"),c&&(m+="flat-shading:"),h&&(m+="morph-targets:"),f&&(m+="morph-normals:");var T=this.cache.get(m);T||(T=r.clone(),d&&(T.skinning=!0),o&&(T.vertexTangents=!0),l&&(T.vertexColors=!0),c&&(T.flatShading=!0),h&&(T.morphTargets=!0),f&&(T.morphNormals=!0),this.cache.add(m,T)),r=T}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",new n.f(t.attributes.uv.array,2)),r.normalScale&&!o&&(r.normalScale.y=-r.normalScale.y),e.material=r},W.prototype.loadMaterial=function(e){var t,o=this.json,l=this.extensions,c=o.materials[e],d={},h=c.extensions||{},f=[];if(h[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var m=l[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=m.getMaterialType(),f.push(m.extendParams(d,c,this))}else if(h[r.KHR_MATERIALS_UNLIT]){var v=l[r.KHR_MATERIALS_UNLIT];t=v.getMaterialType(),f.push(v.extendParams(d,c,this))}else{t=n.K;var y=c.pbrMetallicRoughness||{};if(d.color=new n.j(1,1,1),d.opacity=1,Array.isArray(y.baseColorFactor)){var w=y.baseColorFactor;d.color.fromArray(w),d.opacity=w[3]}void 0!==y.baseColorTexture&&f.push(this.assignTexture(d,"map",y.baseColorTexture)),d.metalness=void 0!==y.metallicFactor?y.metallicFactor:1,d.roughness=void 0!==y.roughnessFactor?y.roughnessFactor:1,void 0!==y.metallicRoughnessTexture&&(f.push(this.assignTexture(d,"metalnessMap",y.metallicRoughnessTexture)),f.push(this.assignTexture(d,"roughnessMap",y.metallicRoughnessTexture)))}!0===c.doubleSided&&(d.side=n.l);var A=c.alphaMode||F;return A===G?(d.transparent=!0,d.depthWrite=!1):(d.transparent=!1,A===N&&(d.alphaTest=void 0!==c.alphaCutoff?c.alphaCutoff:.5)),void 0!==c.normalTexture&&t!==n.J&&(f.push(this.assignTexture(d,"normalMap",c.normalTexture)),d.normalScale=new n.qb(1,1),void 0!==c.normalTexture.scale&&d.normalScale.set(c.normalTexture.scale,c.normalTexture.scale)),void 0!==c.occlusionTexture&&t!==n.J&&(f.push(this.assignTexture(d,"aoMap",c.occlusionTexture)),void 0!==c.occlusionTexture.strength&&(d.aoMapIntensity=c.occlusionTexture.strength)),void 0!==c.emissiveFactor&&t!==n.J&&(d.emissive=(new n.j).fromArray(c.emissiveFactor)),void 0!==c.emissiveTexture&&t!==n.J&&f.push(this.assignTexture(d,"emissiveMap",c.emissiveTexture)),Promise.all(f).then((function(){var e;return e=t===T?l[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(d):new t(d),c.name&&(e.name=c.name),e.map&&(e.map.encoding=n.vb),e.emissiveMap&&(e.emissiveMap.encoding=n.vb),V(e,c),c.extensions&&K(l,e,c),e}))},W.prototype.loadGeometries=function(e){var t=this,o=this.extensions,l=this.primitiveCache;function c(e){return o[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return J(r,e,t)}))}for(var d,h,f=[],i=0,m=e.length;i<m;i++){var v,y=e[i],T=(h=void 0,(h=(d=y).extensions&&d.extensions[r.KHR_DRACO_MESH_COMPRESSION])?"draco:"+h.bufferView+":"+h.indices+":"+z(h.attributes):d.indices+":"+z(d.attributes)+":"+d.mode),w=l[T];if(w)f.push(w.promise);else v=y.extensions&&y.extensions[r.KHR_DRACO_MESH_COMPRESSION]?c(y):J(new n.g,y,t),l[T]={primitive:y,promise:v},f.push(v)}return Promise.all(f)},W.prototype.loadMesh=function(e){for(var t,r=this,o=this.json.meshes[e],l=o.primitives,c=[],i=0,d=l.length;i<d;i++){var h=void 0===l[i].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new n.K({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.n})),t.DefaultMaterial):this.getDependency("material",l[i].material);c.push(h)}return c.push(r.loadGeometries(l)),Promise.all(c).then((function(t){for(var c=t.slice(0,t.length-1),d=t[t.length-1],h=[],i=0,f=d.length;i<f;i++){var m,v=d[i],y=l[i],T=c[i];if(y.mode===L||y.mode===x||y.mode===I||void 0===y.mode)!0!==(m=!0===o.isSkinnedMesh?new n.hb(v,T):new n.I(v,T)).isSkinnedMesh||m.geometry.attributes.skinWeight.normalized||m.normalizeSkinWeights(),y.mode===x?m.geometry=Y(m.geometry,n.nb):y.mode===I&&(m.geometry=Y(m.geometry,n.mb));else if(y.mode===M)m=new n.y(v,T);else if(y.mode===E)m=new n.v(v,T);else if(y.mode===_)m=new n.x(v,T);else{if(y.mode!==S)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+y.mode);m=new n.U(v,T)}Object.keys(m.geometry.morphAttributes).length>0&&X(m,o),m.name=o.name||"mesh_"+e,d.length>1&&(m.name+="_"+i),V(m,o),r.assignFinalMaterial(m),h.push(m)}if(1===h.length)return h[0];var w=new n.p;for(i=0,f=h.length;i<f;i++)w.add(h[i]);return w}))},W.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],o=r[r.type];if(o)return"perspective"===r.type?t=new n.S(n.G.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):"orthographic"===r.type&&(t=new n.R(o.xmag/-2,o.xmag/2,o.ymag/2,o.ymag/-2,o.znear,o.zfar)),r.name&&(t.name=r.name),V(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},W.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},W.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],o=[],l=[],c=[],d=[],i=0,h=t.channels.length;i<h;i++){var f=t.channels[i],m=t.samplers[f.sampler],v=f.target,y=void 0!==v.node?v.node:v.id,input=void 0!==t.parameters?t.parameters[m.input]:m.input,output=void 0!==t.parameters?t.parameters[m.output]:m.output;r.push(this.getDependency("node",y)),o.push(this.getDependency("accessor",input)),l.push(this.getDependency("accessor",output)),c.push(m),d.push(v)}return Promise.all([Promise.all(r),Promise.all(o),Promise.all(l),Promise.all(c),Promise.all(d)]).then((function(r){for(var o=r[0],l=r[1],c=r[2],d=r[3],h=r[4],f=[],i=0,m=o.length;i<m;i++){var v=o[i],y=l[i],T=c[i],w=d[i],A=h[i];if(void 0!==v){var S;switch(v.updateMatrix(),v.matrixAutoUpdate=!0,k[A.path]){case k.weights:S=n.P;break;case k.rotation:S=n.X;break;case k.position:case k.scale:default:S=n.sb}var M=v.name?v.name:v.uuid,_=void 0!==w.interpolation?H[w.interpolation]:n.u,E=[];k[A.path]===k.weights?v.traverse((function(object){!0===object.isMesh&&object.morphTargetInfluences&&E.push(object.name?object.name:object.uuid)})):E.push(M);var L=T.array;if(T.normalized){var x;if(L.constructor===Int8Array)x=1/127;else if(L.constructor===Uint8Array)x=1/255;else if(L.constructor==Int16Array)x=1/32767;else{if(L.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");x=1/65535}for(var I=new Float32Array(L.length),D=0,P=L.length;D<P;D++)I[D]=L[D]*x;L=I}for(D=0,P=E.length;D<P;D++){var track=new S(E[D]+"."+k[A.path],y.array,L,_);"CUBICSPLINE"===w.interpolation&&(track.createInterpolant=function(e){return new R(this.times,this.values,this.getValueSize()/3,e)},track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),f.push(track)}}}var C=t.name?t.name:"animation_"+e;return new n.a(C,void 0,f)}))},W.prototype.loadNode=function(e){var t,o=this.json,l=this.extensions,c=this,d=o.meshReferences,h=o.meshUses,f=o.nodes[e];return(t=[],void 0!==f.mesh&&t.push(c.getDependency("mesh",f.mesh).then((function(e){var t;if(d[f.mesh]>1){var r=h[f.mesh]++;(t=e.clone()).name+="_instance_"+r}else t=e;return void 0!==f.weights&&t.traverse((function(e){if(e.isMesh)for(var i=0,t=f.weights.length;i<t;i++)e.morphTargetInfluences[i]=f.weights[i]})),t}))),void 0!==f.camera&&t.push(c.getDependency("camera",f.camera)),f.extensions&&f.extensions[r.KHR_LIGHTS_PUNCTUAL]&&void 0!==f.extensions[r.KHR_LIGHTS_PUNCTUAL].light&&t.push(c.getDependency("light",f.extensions[r.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then((function(e){var t;if((t=!0===f.isBone?new n.d:e.length>1?new n.p:1===e.length?e[0]:new n.Q)!==e[0])for(var i=0,r=e.length;i<r;i++)t.add(e[i]);if(f.name&&(t.userData.name=f.name,t.name=n.W.sanitizeNodeName(f.name)),V(t,f),f.extensions&&K(l,t,f),void 0!==f.matrix){var o=new n.H;o.fromArray(f.matrix),t.applyMatrix4(o)}else void 0!==f.translation&&t.position.fromArray(f.translation),void 0!==f.rotation&&t.quaternion.fromArray(f.rotation),void 0!==f.scale&&t.scale.fromArray(f.scale);return t}))},W.prototype.loadScene=function(){function e(t,r,o,l){var c=o.nodes[t];return l.getDependency("node",t).then((function(e){return void 0===c.skin?e:l.getDependency("skin",c.skin).then((function(e){for(var r=[],i=0,n=(t=e).joints.length;i<n;i++)r.push(l.getDependency("node",t.joints[i]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(e.isMesh){for(var o=[],l=[],c=0,d=r.length;c<d;c++){var h=r[c];if(h){o.push(h);var f=new n.H;void 0!==t.inverseBindMatrices&&f.fromArray(t.inverseBindMatrices.array,16*c),l.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}e.bind(new n.gb(o,l),e.matrixWorld)}})),e}));var t})).then((function(t){r.add(t);var n=[];if(c.children)for(var d=c.children,i=0,h=d.length;i<h;i++){var f=d[i];n.push(e(f,t,o,l))}return Promise.all(n)}))}return function(t){var r=this.json,o=this.extensions,l=this.json.scenes[t],c=new n.p;l.name&&(c.name=l.name),V(c,l),l.extensions&&K(o,c,l);for(var d=l.nodes||[],h=[],i=0,f=d.length;i<f;i++)h.push(e(d[i],c,r,this));return Promise.all(h).then((function(){return c}))}}(),e}()}}]);